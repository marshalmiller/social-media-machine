import{c as D,a as N,r as p,R as C,m as P,j as e,g as R,b as z,N as y}from"./index-02b2945e.js";import{I as $,T as L,C as B,D as F,a as E,F as A,b as G,P as T,R as W}from"./DeleteDialog-657ad9e0.js";import{S as v}from"./Spacer-de9dcc41.js";import{I as q}from"./IconMenu-6e6ac8e9.js";import{I as f}from"./Item-79c80338.js";import{C as H,P as O}from"./PhoneAndroid-c91f5110.js";import{Q,P as K}from"./Person-411c868c.js";import{I as J}from"./ImageSearch-6df1d0d1.js";import{k as M,n as V}from"./settingsState-c28045a5.js";import{o as X,n as S,j as Y,q as Z,r as ee,p as oe}from"./menuState-2ff024b1.js";import{I as x}from"./IconButton-02bc1303.js";import{u as te}from"./profiler-25e786d5.js";import{b as se}from"./content-ab9124ab.js";import{I as re}from"./ImageCloud-fcac825d.js";import{W as ae}from"./UserProfilePure-9f741110.js";import{u as ie,c as ne}from"./UserListing-e60983b4.js";import{c as le}from"./colours.module-29b309d0.js";import{a as ce}from"./events-63b5f19e.js";import"./Popover-f0f4a007.js";import"./createSimplePaletteValueFilter-b2e05aa4.js";import"./useSlot-050d423d.js";import"./Portal-a2b43acb.js";import"./Modal-2fc077e7.js";import"./debounce-517eeb3c.js";import"./Grow-605dc19c.js";import"./Slider-01724717.js";import"./useSlotProps-2393cf25.js";import"./Feed-95058eca.js";import"./style.module-950f526a.js";import"./TextField-43fc95d4.js";import"./useFormControl-e419a457.js";import"./index-720786c4.js";import"./localiser-c0c9a31b.js";import"./Close-50ef3ec2.js";import"./LangSelect-6fc7f25d.js";import"./configState-6be3aa1d.js";import"./recommender-9b8a9795.js";import"./sessionState-6915fb12.js";import"./DataProfile-29b73b7e.js";import"./DataProfilePure-287e5c3b.js";import"./ScorePie-ef00e97d.js";import"./ChartsOverlay-21326cdb.js";import"./useThemeProps-e50455dd.js";import"./Typography-0738e1b3.js";import"./Popper-912b4204.js";import"./FileSaver.min-7671c644.js";import"./PrintButton-dcdd5a18.js";import"./random-67c94df7.js";import"./IconMenuInline-1e64afd8.js";import"./svgToPNG-975d57d1.js";import"./Download-633f4aec.js";import"./UserProfile-c3f95e1b.js";import"./I18nextProvider-f367c211.js";import"./RecommendationsProfile-bfc2e545.js";import"./Graph-d1b46b16.js";import"./ProgressDialog-7226fde1.js";import"./DialogContent-d100c3e0.js";import"./DialogTitle-3bd65ba4.js";import"./LinearProgress-51654afb.js";import"./Label-2d9d5124.js";import"./graphColours-c6ae9e73.js";import"./RadioGroup-2c88d32f.js";import"./SwitchBase-b2e27e4d.js";import"./ImageGrid-ff60fbdd.js";import"./CheckCircle-b71d1d84.js";import"./Refresh-d5d9edd3.js";import"./LocalFireDepartment-2907a69f.js";import"./RecommendationsHeatmap-cbbc4619.js";import"./colours-9cdd3933.js";import"./DialogActions-6d630794.js";import"./Tooltip-875b66b4.js";import"./style.module-fd5d79c8.js";const de="#dfe5e8",me="#008297",pe="rgb(174, 37, 174)",ue="#5f7377",he="_menuLogo_dtzbu_3",ge="_grid_dtzbu_14",be="_gridItem_dtzbu_25",fe="_userImageContainer_dtzbu_55",xe="_placeholder_dtzbu_72",je="_colourBox_dtzbu_85",Ce="_userNameContainer_dtzbu_90",we="_selectedUserNameContainer_dtzbu_105 _userNameContainer_dtzbu_90",Ie="_word_dtzbu_110",h={workspaceBg:de,primary:me,secondary:pe,backgroundDark:ue,menuLogo:he,grid:ge,gridItem:be,userImageContainer:fe,placeholder:xe,colourBox:je,userNameContainer:Ce,selectedUserNameContainer:we,word:Ie};function _e(){var k,U;const{t:o}=D(),[u,a]=N(M),[d,c]=p.useState(!1),[g,r]=N(X),[t,j]=N(S),l=C(Y),b=C(Z),i=C(ee),s=C(oe),n=p.useRef(),{profiler:m,actionLog:w,similarity:I}=P();return p.useEffect(()=>{t&&t!==n.current&&s!=="none"&&r(s),n.current=t},[t,s,r]),l?e.jsxs(q,{placement:"top",selected:!!t,label:e.jsx("div",{className:h.menuLogo,children:t?(k=m.getUserData(t))==null?void 0:k.name:o("dashboard.titles.people")}),children:[!i&&e.jsxs(e.Fragment,{children:[e.jsx(f,{tooltip:o("dashboard.labels.profileImage"),selected:u==="profileImage",children:e.jsx(x,{color:"inherit",onClick:()=>a("profileImage"),"data-testid":"social-menu-profileImage","aria-label":o("dashboard.labels.profileImage"),children:e.jsx($,{})})}),e.jsx(f,{tooltip:o("dashboard.labels.engagedImages"),selected:u==="image",children:e.jsx(x,{color:"inherit",onClick:()=>a("image"),"data-testid":"social-menu-images","aria-label":o("dashboard.labels.engagedImages"),children:e.jsx(H,{})})}),e.jsx(f,{tooltip:o("dashboard.labels.topicCloud"),selected:u==="word",children:e.jsx(x,{color:"inherit",onClick:()=>a("word"),"aria-label":o("dashboard.labels.topicCloud"),children:e.jsx(L,{})})}),e.jsx(v,{})]}),e.jsx(B,{}),e.jsx(v,{}),!b&&e.jsxs(e.Fragment,{children:[e.jsx(f,{tooltip:o("dashboard.labels.showFeed"),selected:g==="feed",children:e.jsx(x,{disabled:!t,"data-testid":"social-menu-feed-button",color:"inherit",onClick:()=>r("feed"),"aria-label":o("dashboard.labels.showFeed"),children:e.jsx(O,{})})}),e.jsx(f,{tooltip:o("dashboard.labels.showData"),selected:g==="data",children:e.jsx(x,{disabled:!t,"data-testid":"social-menu-data-button",color:"inherit",onClick:()=>r("data"),"aria-label":o("dashboard.labels.showData"),children:e.jsx(Q,{})})}),e.jsx(f,{tooltip:o("dashboard.labels.showProfile"),selected:g==="profile",children:e.jsx(x,{disabled:!t,"data-testid":"social-menu-profile-button",color:"inherit",onClick:()=>r("profile"),"aria-label":o("dashboard.labels.showProfile"),children:e.jsx(K,{})})}),e.jsx(f,{tooltip:o("dashboard.labels.showRecommendations"),selected:g==="recommendations",children:e.jsx(x,{disabled:!t,"data-testid":"social-menu-recom-button",color:"inherit",onClick:()=>r("recommendations"),"aria-label":o("dashboard.labels.showRecommendations"),children:e.jsx(J,{})})}),e.jsx(v,{})]}),e.jsx(f,{tooltip:o("dashboard.labels.deleteUser"),children:e.jsx(x,{disabled:!t,color:"inherit",onClick:()=>c(!0),"aria-label":o("dashboard.labels.deleteUser"),children:e.jsx(F,{})})}),t&&e.jsx(E,{name:((U=m.getUserData(t))==null?void 0:U.name)||"No Name",open:d,onClose:()=>c(!1),onDelete:()=>{m.removeProfile(t),w.removeLogs(t),I.reset(),j(void 0),c(!1)}})]}):null}const _=1;function Ne({id:o,colour:u}){const a=te(o),d=se(a.image),[c,g]=N(S),r=C(M),t=R(),j=p.useRef(null),[l,b]=p.useState(300),i=p.useCallback(s=>{b(s)},[]);return e.jsxs("button",{tabIndex:0,"data-testid":`user-grid-item-${o}`,"aria-pressed":c===o,className:h.gridItem,onClick:s=>{g(n=>n===o?void 0:o),s.stopPropagation()},children:[e.jsxs("div",{className:h.userImageContainer,children:[r==="profileImage"&&d&&e.jsx("img",{src:d,alt:"","data-testid":`profile-image-${o}`}),r==="profileImage"&&!d&&e.jsx("div",{className:h.placeholder}),r==="image"&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:`${-(l*_)} ${-l} ${l*_*2} ${l*2}`,ref:j,"data-testid":`imagecloud-${o}`,children:e.jsx(re,{content:a.affinities.contents.contents.map(s=>({weight:s.weight,image:t.getContentData(s.id,!0)||""})),size:300,onSize:i,count:10})}),r==="word"&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",ref:j,"data-testid":`wordcloud-${o}`,viewBox:`${-(l*_)} ${-l} ${l*_*2} ${l*2}`,children:e.jsx(ae,{content:a.affinities.topics.topics,size:300,className:h.word,onSize:i})})]}),e.jsxs("div",{className:c===o?h.selectedUserNameContainer:h.userNameContainer,children:[e.jsx("div",{className:h.colourBox,style:{background:u}}),a.name]})]})}function Se({users:o}){const{t:u}=D(),{profiler:a,similarity:d}=P(),c=ie(),g=p.useMemo(()=>c.users.filter(i=>i!==a.getCurrentUser()),[c,a]),r=o||g,t=C(V),j=z(S);p.useEffect(()=>{d.setK(t)},[t,d]);const l=Math.ceil(Math.sqrt(r.length))+1;let b=[];if(t>0){const i=new Map;r.forEach(n=>{var I;const m=((I=c.clusters.get(n))==null?void 0:I.label)||"nocluster",w=i.get(m)||[];w.push(n),i.set(m,w)});const s=Array.from(i);s.sort((n,m)=>m[0].localeCompare(n[0])),b=s.reduce((n,m)=>[...n,...m[1]],[])}else b=r;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:h.grid,style:{gridTemplateColumns:`repeat(${l}, 1fr)`},onClick:()=>j(void 0),"data-testid":"usergrid",children:[b.length===0&&e.jsx(y,{loading:!0,message:u("dashboard.messages.waitingPeople")}),b.map(i=>{var n;const s=(n=c.clusters.get(i))==null?void 0:n.label;return e.jsx(Ne,{id:i,colour:s?ne(s):le.primary},i)})]}),e.jsx(_e,{}),e.jsx(A,{}),e.jsx(G,{}),e.jsx(T,{}),e.jsx(W,{})]})}function Ho(){const[o,u]=p.useReducer(d=>++d,0);ce(()=>{u()},[],"refresh_graph");const a=z(S);return p.useEffect(()=>{a(void 0)},[a]),e.jsx(Se,{},`k-${o}`)}export{Ho as Component};
