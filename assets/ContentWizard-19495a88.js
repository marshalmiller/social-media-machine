import{r as m,j as a,I as lt,ag as Es,H as pt,G as $s,x as gt,_ as j,c as W,g as U,h as Ls,i as Re,A as Rs,a3 as Ne,K as mt,F as De,R as ie,ah as Ns,ai as Ds,aj as zs,ak as Bs,a as Fs,m as Hs,b as Os,M as Gs}from"./index-02b2945e.js";import{W as J,e as Ws,g as Us,S as Ks}from"./Widget-faef6aca.js";import{S as Xs}from"./Search-2d830196.js";import{w as oe,m as Ys,A as ze}from"./Add-0779dc75.js";import{D as re,a as le}from"./DialogContent-d100c3e0.js";import{D as ce}from"./DialogTitle-3bd65ba4.js";import{L as Vs}from"./LinearProgress-51654afb.js";import{S as st}from"./Slider-01724717.js";import{D as Be}from"./DialogActions-6d630794.js";import{T as Tt,M as Et,F as qs,I as Qs,S as Js}from"./TextField-43fc95d4.js";import{I as de}from"./InputAdornment-0277bb49.js";import{R as Zs,a as ye}from"./RadioGroup-2c88d32f.js";import{F as xt,C as St}from"./FormControlLabel-5a6070f0.js";import{a as ue,b as dt,T as Fe,s as tn}from"./fileSaver-abb1abfd.js";import{b as He}from"./graph-01dd06dc.js";import{M as $t}from"./Menu-ad377c0c.js";import{c as he,B as en,I as nt}from"./IconButton-02bc1303.js";import{M as Y}from"./MenuItem-97c66a8d.js";import{F as sn,L as nn,D as an,A as pe}from"./DataGrid-d15b9d8f.js";import{F as on}from"./FileSaver.min-7671c644.js";import{I as Lt}from"./ImageGrid-ff60fbdd.js";import{a as Oe,u as rn}from"./events-63b5f19e.js";import{g as at,a as it,s as V,m as ge,d as _e,u as Ge,c as se,b as ot,_ as H,i as We}from"./createSimplePaletteValueFilter-b2e05aa4.js";import{w as xe,i as F,E as Ue,t as Rt,f as Z,p as ne,s as wt,c as Ke,e as ve,n as ln,D as cn,F as yt,G as Xe,H as ut,I as dn,J as un,K as Nt,k as ct,L as It,u as _t,o as ft,M as Ce,N as hn,x as vt,O as Ye,v as Dt,P as pn,Q as gn,R as Ve,y as qe,A as Qe,C as Je,z as Ze,B as ts,S as xn,T as es,U as zt,V as Bt,W as ss,l as je,X as ns}from"./ChartsOverlay-21326cdb.js";import{a as fn,u as Ft}from"./useSlotProps-2393cf25.js";import{u as Ht}from"./useThemeProps-e50455dd.js";import{u as mn}from"./Portal-a2b43acb.js";import{R as bn}from"./Refresh-d5d9edd3.js";import{C as Ot}from"./settingsState-c28045a5.js";import{I as Qt}from"./Item-79c80338.js";import{I as yn}from"./IconMenu-6e6ac8e9.js";import{u as jt}from"./useSlot-050d423d.js";import{h as _n}from"./colours-9cdd3933.js";import{C as ke}from"./Chip-3c6505fa.js";import{d as vn}from"./content-ab9124ab.js";import{D as Cn}from"./Download-633f4aec.js";import{u as jn}from"./settings-1d1f0ea7.js";import{e as kn}from"./errorState-b147a579.js";import{S as An}from"./Settings-ceaef721.js";import{C as Pn}from"./Close-50ef3ec2.js";import{I as Sn}from"./I18nextProvider-f367c211.js";import"./Edit-32806028.js";import"./Modal-2fc077e7.js";import"./Typography-0738e1b3.js";import"./index-720786c4.js";import"./Popover-f0f4a007.js";import"./debounce-517eeb3c.js";import"./Grow-605dc19c.js";import"./useFormControl-e419a457.js";import"./SwitchBase-b2e27e4d.js";import"./EventManager-36c7dc68.js";import"./v4-eb618527.js";import"./Close-223ffcde.js";import"./Popper-912b4204.js";import"./Button-c681e6d6.js";import"./Tooltip-875b66b4.js";import"./CheckCircle-b71d1d84.js";import"./menuState-2ff024b1.js";import"./configState-6be3aa1d.js";const as=m.forwardRef(function({busy:t,...e},s){return a.jsx(lt,{ref:s,...e,disabled:t||e.disabled,sx:{...e.sx,"& .MuiCircularProgress-root":{width:"20px !important",height:"20px !important"}},startIcon:t?a.jsx(Es,{}):e.startIcon,children:e.children})});function wn(t){return at("MuiPagination",t)}it("MuiPagination",["root","ul","outlined","text"]);function In(t={}){const{boundaryCount:e=1,componentName:s="usePagination",count:i=1,defaultPage:o=1,disabled:n=!1,hideNextButton:r=!1,hidePrevButton:l=!1,onChange:c,page:d,showFirstButton:g=!1,showLastButton:u=!1,siblingCount:p=1,...f}=t,[h,x]=fn({controlled:d,default:o,name:s,state:"page"}),y=(w,P)=>{d||x(P),c&&c(w,P)},v=(w,P)=>{const E=P-w+1;return Array.from({length:E},(R,N)=>w+N)},b=v(1,Math.min(e,i)),_=v(Math.max(i-e+1,e+1),i),C=Math.max(Math.min(h-p,i-e-p*2-1),e+2),k=Math.min(Math.max(h+p,e+p*2+2),i-e-1),S=[...g?["first"]:[],...l?[]:["previous"],...b,...C>e+2?["start-ellipsis"]:e+1<i-e?[e+1]:[],...v(C,k),...k<i-e-1?["end-ellipsis"]:i-e>e?[i-e]:[],..._,...r?[]:["next"],...u?["last"]:[]],M=w=>{switch(w){case"first":return 1;case"previous":return h-1;case"next":return h+1;case"last":return i;default:return null}};return{items:S.map(w=>typeof w=="number"?{onClick:P=>{y(P,w)},type:"page",page:w,selected:w===h,disabled:n,"aria-current":w===h?"page":void 0}:{onClick:P=>{y(P,M(w))},type:w,page:M(w),selected:!1,disabled:n||!w.includes("ellipsis")&&(w==="next"||w==="last"?h>=i:h<=1)}),...f}}function Mn(t){return at("MuiPaginationItem",t)}const Tn=it("MuiPaginationItem",["root","page","sizeSmall","sizeLarge","text","textPrimary","textSecondary","outlined","outlinedPrimary","outlinedSecondary","rounded","ellipsis","firstLast","previousNext","focusVisible","disabled","selected","icon","colorPrimary","colorSecondary"]),X=Tn,En=he(a.jsx("path",{d:"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore"),$n=he(a.jsx("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext"),is=(t,e)=>{const{ownerState:s}=t;return[e.root,e[s.variant],e[`size${gt(s.size)}`],s.variant==="text"&&e[`text${gt(s.color)}`],s.variant==="outlined"&&e[`outlined${gt(s.color)}`],s.shape==="rounded"&&e.rounded,s.type==="page"&&e.page,(s.type==="start-ellipsis"||s.type==="end-ellipsis")&&e.ellipsis,(s.type==="previous"||s.type==="next")&&e.previousNext,(s.type==="first"||s.type==="last")&&e.firstLast]},Ln=t=>{const{classes:e,color:s,disabled:i,selected:o,size:n,shape:r,type:l,variant:c}=t,d={root:["root",`size${gt(n)}`,c,r,s!=="standard"&&`color${gt(s)}`,s!=="standard"&&`${c}${gt(s)}`,i&&"disabled",o&&"selected",{page:"page",first:"firstLast",last:"firstLast","start-ellipsis":"ellipsis","end-ellipsis":"ellipsis",previous:"previousNext",next:"previousNext"}[l]],icon:["icon"]};return ot(d,Mn,e)},Rn=V("div",{name:"MuiPaginationItem",slot:"Root",overridesResolver:is})(ge(({theme:t})=>({...t.typography.body2,borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,padding:"0 6px",margin:"0 3px",color:(t.vars||t).palette.text.primary,height:"auto",[`&.${X.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},variants:[{props:{size:"small"},style:{minWidth:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"}},{props:{size:"large"},style:{minWidth:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15)}}]}))),Nn=V(en,{name:"MuiPaginationItem",slot:"Root",overridesResolver:is})(ge(({theme:t})=>({...t.typography.body2,borderRadius:32/2,textAlign:"center",boxSizing:"border-box",minWidth:32,height:32,padding:"0 6px",margin:"0 3px",color:(t.vars||t).palette.text.primary,[`&.${X.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${X.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},transition:t.transitions.create(["color","background-color"],{duration:t.transitions.duration.short}),"&:hover":{backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${X.selected}`]:{backgroundColor:(t.vars||t).palette.action.selected,"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:pt(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(t.vars||t).palette.action.selected}},[`&.${X.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.action.selectedChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:pt(t.palette.action.selected,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)},[`&.${X.disabled}`]:{opacity:1,color:(t.vars||t).palette.action.disabled,backgroundColor:(t.vars||t).palette.action.selected}},variants:[{props:{size:"small"},style:{minWidth:26,height:26,borderRadius:26/2,margin:"0 1px",padding:"0 4px"}},{props:{size:"large"},style:{minWidth:40,height:40,borderRadius:40/2,padding:"0 10px",fontSize:t.typography.pxToRem(15)}},{props:{shape:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"outlined"},style:{border:t.vars?`1px solid rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:`1px solid ${t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"}`,[`&.${X.selected}`]:{[`&.${X.disabled}`]:{borderColor:(t.vars||t).palette.action.disabledBackground,color:(t.vars||t).palette.action.disabled}}}},{props:{variant:"text"},style:{[`&.${X.selected}`]:{[`&.${X.disabled}`]:{color:(t.vars||t).palette.action.disabled}}}},...Object.entries(t.palette).filter(_e(["dark","contrastText"])).map(([e])=>({props:{variant:"text",color:e},style:{[`&.${X.selected}`]:{color:(t.vars||t).palette[e].contrastText,backgroundColor:(t.vars||t).palette[e].main,"&:hover":{backgroundColor:(t.vars||t).palette[e].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e].main}},[`&.${X.focusVisible}`]:{backgroundColor:(t.vars||t).palette[e].dark},[`&.${X.disabled}`]:{color:(t.vars||t).palette.action.disabled}}}})),...Object.entries(t.palette).filter(_e(["light"])).map(([e])=>({props:{variant:"outlined",color:e},style:{[`&.${X.selected}`]:{color:(t.vars||t).palette[e].main,border:`1px solid ${t.vars?`rgba(${t.vars.palette[e].mainChannel} / 0.5)`:pt(t.palette[e].main,.5)}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e].mainChannel} / ${t.vars.palette.action.activatedOpacity})`:pt(t.palette[e].main,t.palette.action.activatedOpacity),"&:hover":{backgroundColor:t.vars?`rgba(${t.vars.palette[e].mainChannel} / calc(${t.vars.palette.action.activatedOpacity} + ${t.vars.palette.action.focusOpacity}))`:pt(t.palette[e].main,t.palette.action.activatedOpacity+t.palette.action.focusOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${X.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette[e].mainChannel} / calc(${t.vars.palette.action.activatedOpacity} + ${t.vars.palette.action.focusOpacity}))`:pt(t.palette[e].main,t.palette.action.activatedOpacity+t.palette.action.focusOpacity)}}}}))]}))),Dn=V("div",{name:"MuiPaginationItem",slot:"Icon",overridesResolver:(t,e)=>e.icon})(ge(({theme:t})=>({fontSize:t.typography.pxToRem(20),margin:"0 -8px",variants:[{props:{size:"small"},style:{fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{fontSize:t.typography.pxToRem(22)}}]}))),zn=m.forwardRef(function(e,s){const i=Ge({props:e,name:"MuiPaginationItem"}),{className:o,color:n="standard",component:r,components:l={},disabled:c=!1,page:d,selected:g=!1,shape:u="circular",size:p="medium",slots:f={},slotProps:h={},type:x="page",variant:y="text",...v}=i,b={...i,color:n,disabled:c,selected:g,shape:u,size:p,type:x,variant:y},_=$s(),C=Ln(b),k={slots:{previous:f.previous??l.previous,next:f.next??l.next,first:f.first??l.first,last:f.last??l.last},slotProps:h},[S,M]=jt("previous",{elementType:En,externalForwardedProps:k,ownerState:b}),[T,w]=jt("next",{elementType:$n,externalForwardedProps:k,ownerState:b}),[P,E]=jt("first",{elementType:sn,externalForwardedProps:k,ownerState:b}),[R,N]=jt("last",{elementType:nn,externalForwardedProps:k,ownerState:b}),A=_?{previous:"next",next:"previous",first:"last",last:"first"}[x]:x,I={previous:S,next:T,first:P,last:R}[A],D={previous:M,next:w,first:E,last:N}[A];return x==="start-ellipsis"||x==="end-ellipsis"?a.jsx(Rn,{ref:s,ownerState:b,className:se(C.root,o),children:"…"}):a.jsxs(Nn,{ref:s,ownerState:b,component:r,disabled:c,className:se(C.root,o),...v,children:[x==="page"&&d,I?a.jsx(Dn,{...D,className:C.icon,as:I}):null]})}),Bn=zn,Fn=t=>{const{classes:e,variant:s}=t;return ot({root:["root",s],ul:["ul"]},wn,e)},Hn=V("nav",{name:"MuiPagination",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.root,e[s.variant]]}})({}),On=V("ul",{name:"MuiPagination",slot:"Ul",overridesResolver:(t,e)=>e.ul})({display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"});function Gn(t,e,s){return t==="page"?`${s?"":"Go to "}page ${e}`:`Go to ${t} page`}const Wn=m.forwardRef(function(e,s){const i=Ge({props:e,name:"MuiPagination"}),{boundaryCount:o=1,className:n,color:r="standard",count:l=1,defaultPage:c=1,disabled:d=!1,getItemAriaLabel:g=Gn,hideNextButton:u=!1,hidePrevButton:p=!1,onChange:f,page:h,renderItem:x=P=>a.jsx(Bn,{...P}),shape:y="circular",showFirstButton:v=!1,showLastButton:b=!1,siblingCount:_=1,size:C="medium",variant:k="text",...S}=i,{items:M}=In({...i,componentName:"Pagination"}),T={...i,boundaryCount:o,color:r,count:l,defaultPage:c,disabled:d,getItemAriaLabel:g,hideNextButton:u,hidePrevButton:p,renderItem:x,shape:y,showFirstButton:v,showLastButton:b,siblingCount:_,size:C,variant:k},w=Fn(T);return a.jsx(Hn,{"aria-label":"pagination navigation",className:se(w.root,n),ownerState:T,ref:s,...S,children:a.jsx(On,{className:w.ul,ownerState:T,children:M.map((P,E)=>a.jsx("li",{children:x({...P,color:r,"aria-label":g(P.type,P.page,P.selected),shape:y,size:C,variant:k})},E))})})}),os=Wn;function rs(t){this._context=t}rs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function fe(t){return new rs(t)}function ls(t){return t[0]}function cs(t){return t[1]}function ds(t,e){var s=F(!0),i=null,o=fe,n=null,r=xe(l);t=typeof t=="function"?t:t===void 0?ls:F(t),e=typeof e=="function"?e:e===void 0?cs:F(e);function l(c){var d,g=(c=Ue(c)).length,u,p=!1,f;for(i==null&&(n=o(f=r())),d=0;d<=g;++d)!(d<g&&s(u=c[d],d,c))===p&&((p=!p)?n.lineStart():n.lineEnd()),p&&n.point(+t(u,d,c),+e(u,d,c));if(f)return n=null,f+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:F(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:F(+c),l):e},l.defined=function(c){return arguments.length?(s=typeof c=="function"?c:F(!!c),l):s},l.curve=function(c){return arguments.length?(o=c,i!=null&&(n=o(i)),l):o},l.context=function(c){return arguments.length?(c==null?i=n=null:n=o(i=c),l):i},l}function Un(t,e,s){var i=null,o=F(!0),n=null,r=fe,l=null,c=xe(d);t=typeof t=="function"?t:t===void 0?ls:F(+t),e=typeof e=="function"?e:e===void 0?F(0):F(+e),s=typeof s=="function"?s:s===void 0?cs:F(+s);function d(u){var p,f,h,x=(u=Ue(u)).length,y,v=!1,b,_=new Array(x),C=new Array(x);for(n==null&&(l=r(b=c())),p=0;p<=x;++p){if(!(p<x&&o(y=u[p],p,u))===v)if(v=!v)f=p,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),h=p-1;h>=f;--h)l.point(_[h],C[h]);l.lineEnd(),l.areaEnd()}v&&(_[p]=+t(y,p,u),C[p]=+e(y,p,u),l.point(i?+i(y,p,u):_[p],s?+s(y,p,u):C[p]))}if(b)return l=null,b+""||null}function g(){return ds().defined(o).curve(r).context(n)}return d.x=function(u){return arguments.length?(t=typeof u=="function"?u:F(+u),i=null,d):t},d.x0=function(u){return arguments.length?(t=typeof u=="function"?u:F(+u),d):t},d.x1=function(u){return arguments.length?(i=u==null?null:typeof u=="function"?u:F(+u),d):i},d.y=function(u){return arguments.length?(e=typeof u=="function"?u:F(+u),s=null,d):e},d.y0=function(u){return arguments.length?(e=typeof u=="function"?u:F(+u),d):e},d.y1=function(u){return arguments.length?(s=u==null?null:typeof u=="function"?u:F(+u),d):s},d.lineX0=d.lineY0=function(){return g().x(t).y(e)},d.lineY1=function(){return g().x(t).y(s)},d.lineX1=function(){return g().x(i).y(e)},d.defined=function(u){return arguments.length?(o=typeof u=="function"?u:F(!!u),d):o},d.curve=function(u){return arguments.length?(r=u,n!=null&&(l=r(n)),d):r},d.context=function(u){return arguments.length?(u==null?n=l=null:l=r(n=u),d):n},d}const us={draw(t,e){const s=Z(e/ne);t.moveTo(s,0),t.arc(0,0,s,0,Rt)}},Kn={draw(t,e){const s=Z(e/5)/2;t.moveTo(-3*s,-s),t.lineTo(-s,-s),t.lineTo(-s,-3*s),t.lineTo(s,-3*s),t.lineTo(s,-s),t.lineTo(3*s,-s),t.lineTo(3*s,s),t.lineTo(s,s),t.lineTo(s,3*s),t.lineTo(-s,3*s),t.lineTo(-s,s),t.lineTo(-3*s,s),t.closePath()}},hs=Z(1/3),Xn=hs*2,Yn={draw(t,e){const s=Z(e/Xn),i=s*hs;t.moveTo(0,-s),t.lineTo(i,0),t.lineTo(0,s),t.lineTo(-i,0),t.closePath()}},Vn={draw(t,e){const s=Z(e),i=-s/2;t.rect(i,i,s,s)}},qn=.8908130915292852,ps=wt(ne/10)/wt(7*ne/10),Qn=wt(Rt/10)*ps,Jn=-Ke(Rt/10)*ps,Zn={draw(t,e){const s=Z(e*qn),i=Qn*s,o=Jn*s;t.moveTo(0,-s),t.lineTo(i,o);for(let n=1;n<5;++n){const r=Rt*n/5,l=Ke(r),c=wt(r);t.lineTo(c*s,-l*s),t.lineTo(l*i-c*o,c*i+l*o)}t.closePath()}},Jt=Z(3),ta={draw(t,e){const s=-Z(e/(Jt*3));t.moveTo(0,s*2),t.lineTo(-Jt*s,-s),t.lineTo(Jt*s,-s),t.closePath()}},q=-.5,Q=Z(3)/2,ae=1/Z(12),ea=(ae/2+1)*3,sa={draw(t,e){const s=Z(e/ea),i=s/2,o=s*ae,n=i,r=s*ae+s,l=-n,c=r;t.moveTo(i,o),t.lineTo(n,r),t.lineTo(l,c),t.lineTo(q*i-Q*o,Q*i+q*o),t.lineTo(q*n-Q*r,Q*n+q*r),t.lineTo(q*l-Q*c,Q*l+q*c),t.lineTo(q*i+Q*o,q*o-Q*i),t.lineTo(q*n+Q*r,q*r-Q*n),t.lineTo(q*l+Q*c,q*c-Q*l),t.closePath()}},na=[us,Kn,Yn,Vn,Zn,ta,sa];function aa(t,e){let s=null,i=xe(o);t=typeof t=="function"?t:F(t||us),e=typeof e=="function"?e:F(e===void 0?64:+e);function o(){let n;if(s||(s=n=i()),t.apply(this,arguments).draw(s,+e.apply(this,arguments)),n)return s=null,n+""||null}return o.type=function(n){return arguments.length?(t=typeof n=="function"?n:F(n),o):t},o.size=function(n){return arguments.length?(e=typeof n=="function"?n:F(+n),o):e},o.context=function(n){return arguments.length?(s=n??null,o):s},o}function Ae(t,e,s){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-s),t._x2,t._y2)}function me(t,e){this._context=t,this._k=(1-e)/6}me.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ae(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Ae(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function s(i){return new me(i,e)}return s.tension=function(i){return t(+i)},s})(0);function ia(t,e,s){var i=t._x1,o=t._y1,n=t._x2,r=t._y2;if(t._l01_a>ve){var l=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*l-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,o=(o*l-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>ve){var d=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,g=3*t._l23_a*(t._l23_a+t._l12_a);n=(n*d+t._x1*t._l23_2a-e*t._l12_2a)/g,r=(r*d+t._y1*t._l23_2a-s*t._l12_2a)/g}t._context.bezierCurveTo(i,o,n,r,t._x2,t._y2)}function gs(t,e){this._context=t,this._alpha=e}gs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var s=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(s*s+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:ia(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const oa=function t(e){function s(i){return e?new gs(i,e):new me(i,0)}return s.alpha=function(i){return t(+i)},s}(.5);function Pe(t){return t<0?-1:1}function Se(t,e,s){var i=t._x1-t._x0,o=e-t._x1,n=(t._y1-t._y0)/(i||o<0&&-0),r=(s-t._y1)/(o||i<0&&-0),l=(n*o+r*i)/(i+o);return(Pe(n)+Pe(r))*Math.min(Math.abs(n),Math.abs(r),.5*Math.abs(l))||0}function we(t,e){var s=t._x1-t._x0;return s?(3*(t._y1-t._y0)/s-e)/2:e}function Zt(t,e,s){var i=t._x0,o=t._y0,n=t._x1,r=t._y1,l=(n-i)/3;t._context.bezierCurveTo(i+l,o+l*e,n-l,r-l*s,n,r)}function Mt(t){this._context=t}Mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Zt(this,this._t0,we(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var s=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Zt(this,we(this,s=Se(this,t,e)),s);break;default:Zt(this,this._t0,s=Se(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=s}}};function xs(t){this._context=new fs(t)}(xs.prototype=Object.create(Mt.prototype)).point=function(t,e){Mt.prototype.point.call(this,e,t)};function fs(t){this._context=t}fs.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,s,i,o,n){this._context.bezierCurveTo(e,t,i,s,n,o)}};function Ie(t){return new Mt(t)}function ra(t){return new xs(t)}function ms(t){this._context=t}ms.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,s=t.length;if(s)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),s===2)this._context.lineTo(t[1],e[1]);else for(var i=Me(t),o=Me(e),n=0,r=1;r<s;++n,++r)this._context.bezierCurveTo(i[0][n],o[0][n],i[1][n],o[1][n],t[r],e[r]);(this._line||this._line!==0&&s===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function Me(t){var e,s=t.length-1,i,o=new Array(s),n=new Array(s),r=new Array(s);for(o[0]=0,n[0]=2,r[0]=t[0]+2*t[1],e=1;e<s-1;++e)o[e]=1,n[e]=4,r[e]=4*t[e]+2*t[e+1];for(o[s-1]=2,n[s-1]=7,r[s-1]=8*t[s-1]+t[s],e=1;e<s;++e)i=o[e]/n[e-1],n[e]-=i,r[e]-=i*r[e-1];for(o[s-1]=r[s-1]/n[s-1],e=s-2;e>=0;--e)o[e]=(r[e]-o[e+1])/n[e];for(n[s-1]=(t[s]+o[s-1])/2,e=0;e<s-1;++e)n[e]=2*t[e+1]-o[e+1];return[o,n]}function la(t){return new ms(t)}function Gt(t,e){this._context=t,this._t=e}Gt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var s=this._x*(1-this._t)+t*this._t;this._context.lineTo(s,this._y),this._context.lineTo(s,e)}break}}this._x=t,this._y=e}};function ca(t){return new Gt(t,.5)}function da(t){return new Gt(t,0)}function ua(t){return new Gt(t,1)}function bt(t){const e=ln();if(!t)return{isHighlighted:!1,isFaded:!1};const s=e.isHighlighted(t),i=!s&&e.isFaded(t);return{isHighlighted:s,isFaded:i}}function be(){const{chartId:t}=m.useContext(cn);return m.useMemo(()=>t,[t])}function bs(t){const{id:e,offset:s}=t,{left:i,top:o,width:n,height:r}=yt(),l=j({top:0,right:0,bottom:0,left:0},s);return a.jsx("clipPath",{id:e,children:a.jsx("rect",{x:i-l.left,y:o-l.top,width:n+l.left+l.right,height:r+l.top+l.bottom})})}function ha(t){return at("MuiChartsGrid",t)}const Te=it("MuiChartsGrid",["root","line","horizontalLine","verticalLine"]),pa=V("g",{name:"MuiChartsGrid",slot:"Root",overridesResolver:(t,e)=>[{[`&.${Te.verticalLine}`]:e.verticalLine},{[`&.${Te.horizontalLine}`]:e.horizontalLine},e.root]})({}),ys=V("line",{name:"MuiChartsGrid",slot:"Line",overridesResolver:(t,e)=>e.line})(({theme:t})=>({stroke:(t.vars||t).palette.divider,shapeRendering:"crispEdges",strokeWidth:1}));function ga(t){const{axis:e,drawingArea:s,classes:i}=t,{scale:o,tickNumber:n,tickInterval:r}=e,l=Xe({scale:o,tickNumber:n,tickInterval:r});return a.jsx(m.Fragment,{children:l.map(({value:c,offset:d})=>a.jsx(ys,{y1:s.top,y2:s.top+s.height,x1:d,x2:d,className:i.verticalLine},`vertical-${c}`))})}function xa(t){const{axis:e,drawingArea:s,classes:i}=t,{scale:o,tickNumber:n,tickInterval:r}=e,l=Xe({scale:o,tickNumber:n,tickInterval:r});return a.jsx(m.Fragment,{children:l.map(({value:c,offset:d})=>a.jsx(ys,{y1:d,y2:d,x1:s.left,x2:s.left+s.width,className:i.horizontalLine},`horizontal-${c}`))})}const fa=["vertical","horizontal"],ma=({classes:t})=>ot({root:["root"],verticalLine:["line","verticalLine"],horizontalLine:["line","horizontalLine"]},ha,t);function _s(t){const e=Ht({props:t,name:"MuiChartsGrid"}),s=yt(),{vertical:i,horizontal:o}=e,n=H(e,fa),{xAxis:r,xAxisIds:l,yAxis:c,yAxisIds:d}=ut(),g=ma(e),u=c[d[0]],p=r[l[0]];return a.jsxs(pa,j({},n,{className:g.root,children:[i&&a.jsx(ga,{axis:p,drawingArea:s,classes:g}),o&&a.jsx(xa,{axis:u,drawingArea:s,classes:g})]}))}function vs(t){const{onAxisClick:e}=t,s=dn(),i=un(),{axis:o}=m.useContext(Nt),{xAxisIds:n,xAxis:r,yAxisIds:l,yAxis:c}=ut();return m.useEffect(()=>{const d=s.current;if(d===null||!e)return()=>{};const g=u=>{var v;u.preventDefault();const p=o.x&&o.x.index!==-1,f=p?n[0]:l[0],h=p?o.x&&o.x.index:o.y&&o.y.index;if(h==null)return;const x={};Object.keys(i).filter(b=>["bar","line"].includes(b)).forEach(b=>{var _;(_=i[b])==null||_.seriesOrder.forEach(C=>{const k=i[b].series[C],S=k.xAxisId??k.xAxisKey,M=k.yAxisId??k.yAxisKey,T=p?S:M;(T===void 0||T===f)&&(x[C]=k.data[h])})});const y=(v=(p?r:c)[f].data)==null?void 0:v[h];e(u,{dataIndex:h,axisValue:y,seriesValues:x})};return d.addEventListener("click",g),()=>{d.removeEventListener("click",g)}},[o.x,o.y,e,i,s,r,n,c,l]),a.jsx(m.Fragment,{})}const ba=["id","dataIndex","classes","color","slots","slotProps","style","onClick"];function ya(t){return at("MuiBarElement",t)}it("MuiBarElement",["root"]);const _a=t=>{const{classes:e,id:s}=t,i={root:["root",`series-${s}`]};return ot(i,ya,e)},va=V(ct.rect,{name:"MuiBarElement",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>({stroke:"none",fill:t.isHighlighted?It(t.color).brighter(.5).formatHex():t.color,transition:"opacity 0.2s ease-in, fill 0.2s ease-in",opacity:t.isFaded&&.3||1}));function Ca(t){const{id:e,dataIndex:s,classes:i,color:o,slots:n,slotProps:r,style:l,onClick:c}=t,d=H(t,ba),g=_t(),{isFaded:u,isHighlighted:p}=bt({seriesId:e,dataIndex:s}),f={id:e,dataIndex:s,classes:i,color:o,isFaded:u,isHighlighted:p},h=_a(f),x=(n==null?void 0:n.bar)??va,y=Ft({elementType:x,externalSlotProps:r==null?void 0:r.bar,externalForwardedProps:d,additionalProps:j({},g({type:"bar",seriesId:e,dataIndex:s}),{style:l,onClick:c,cursor:c?"pointer":"unset"}),className:h.root,ownerState:f});return a.jsx(x,j({},y))}const kt=(t,{hasNegative:e,hasPositive:s,borderRadius:i,layout:o})=>{if(!i)return 0;const n=o==="vertical";return t==="top-left"&&(n&&s||!n&&e)||t==="top-right"&&(n&&s||!n&&s)||t==="bottom-right"&&(n&&e||!n&&s)||t==="bottom-left"&&(n&&e||!n&&e)?i:0},ja=["style","maskId"],ka=t=>`inset(0px round ${t.topLeft}px ${t.topRight}px ${t.bottomRight}px ${t.bottomLeft}px)`;function Aa(t){var s,i;const e=t.ownerState;return a.jsx(ct.rect,{style:j({},t.style,{clipPath:(t.ownerState.layout==="vertical"?(s=t.style)==null?void 0:s.height:(i=t.style)==null?void 0:i.width).to(o=>ka({topLeft:Math.min(o,kt("top-left",e)),topRight:Math.min(o,kt("top-right",e)),bottomRight:Math.min(o,kt("bottom-right",e)),bottomLeft:Math.min(o,kt("bottom-left",e))}))})})}function Pa(t){const{style:e,maskId:s}=t,i=H(t,ja);return!t.borderRadius||t.borderRadius<=0?null:a.jsx("clipPath",{id:s,children:a.jsx(Aa,{ownerState:i,style:e})})}function Sa(t){return at("MuiBarLabel",t)}const te=it("MuiBarLabel",["root","highlighted","faded"]),wa=t=>{const{classes:e,seriesId:s,isFaded:i,isHighlighted:o}=t,n={root:["root",`series-${s}`,o&&"highlighted",i&&"faded"]};return ot(n,Sa,e)},Ia=t=>{const{barLabel:e,value:s,dataIndex:i,seriesId:o,height:n,width:r}=t;return e==="value"?s?s==null?void 0:s.toString():null:e({seriesId:o,dataIndex:i,value:s},{bar:{height:n,width:r}})},Ma=["seriesId","dataIndex","color","isFaded","isHighlighted","classes"],Ta=V(ct.text,{name:"MuiBarLabel",slot:"Root",overridesResolver:(t,e)=>[{[`&.${te.faded}`]:e.faded},{[`&.${te.highlighted}`]:e.highlighted},e.root]})(({theme:t})=>{var e,s,i,o;return j({},(e=t==null?void 0:t.typography)==null?void 0:e.body2,{stroke:"none",fill:(o=(i=(s=t.vars||t)==null?void 0:s.palette)==null?void 0:i.text)==null?void 0:o.primary,transition:"opacity 0.2s ease-in, fill 0.2s ease-in",textAnchor:"middle",dominantBaseline:"central",pointerEvents:"none",opacity:1,[`&.${te.faded}`]:{opacity:.3}})});function Ea(t){const e=Ht({props:t,name:"MuiBarLabel"}),s=H(e,Ma);return a.jsx(Ta,j({},s))}const $a=["seriesId","classes","color","style","dataIndex","barLabel","slots","slotProps","height","width","value"],La=["ownerState"];function Ra(t){const{seriesId:e,classes:s,color:i,style:o,dataIndex:n,barLabel:r,slots:l,slotProps:c,height:d,width:g,value:u}=t,p=H(t,$a),{isFaded:f,isHighlighted:h}=bt({seriesId:e,dataIndex:n}),x={seriesId:e,classes:s,color:i,isFaded:f,isHighlighted:h,dataIndex:n},y=wa(x),v=(l==null?void 0:l.barLabel)??Ea,b=Ft({elementType:v,externalSlotProps:c==null?void 0:c.barLabel,additionalProps:j({},p,{style:o,className:y.root}),ownerState:x}),{ownerState:_}=b,C=H(b,La);if(!r)return null;const k=Ia({barLabel:r,value:u,dataIndex:n,seriesId:e,height:d,width:g});return k?a.jsx(v,j({},C,_,{children:k})):null}const Na=["bars","skipAnimation"],Da=({layout:t,yOrigin:e,x:s,width:i,y:o,xOrigin:n,height:r})=>j({},t==="vertical"?{y:e,x:s+i/2,height:0,width:i}:{y:o+r/2,x:n,height:r,width:0}),Ee=({x:t,width:e,y:s,height:i})=>({x:t+e/2,y:s+i/2,height:i,width:e});function za(t){const{bars:e,skipAnimation:s}=t,i=H(t,Na),o=ft(e,{keys:n=>`${n.seriesId}-${n.dataIndex}`,from:Da,leave:null,enter:Ee,update:Ee,immediate:s});return a.jsx(m.Fragment,{children:o((n,{seriesId:r,dataIndex:l,color:c,value:d,width:g,height:u})=>a.jsx(Ra,j({seriesId:r,dataIndex:l,value:d,color:c,width:g,height:u},i,{style:n})))})}const ee=(t,e)=>{const s=`${t}-axis`,i=`${t}Axis`;return e===(t==="x"?vt:Ye)?`The first \`${i}\``:`The ${s} with id "${e}"`};function Ba(t,e,s,i,o,n){const r=i[s],l=n[o],c=t?r:l,d=t?l:r,g=t?s:o,u=t?o:s,p=t?"x":"y",f=t?"y":"x";if(!Ce(c))throw new Error(`MUI X: ${ee(p,g)} should be of type "band" to display the bar series of id "${e}".`);if(c.data===void 0)throw new Error(`MUI X: ${ee(p,g)} should have data property.`);if(Ce(d)||hn(d))throw new Error(`MUI X: ${ee(f,u)} should be a continuous type to display the bar series of id "${e}".`)}const Fa=["skipAnimation","onItemClick","borderRadius","barLabel"];function Ha({bandWidth:t,numberOfGroups:e,gapRatio:s}){if(s===0)return{barWidth:t/e,offset:0};const i=t/(e+(e-1)*s),o=s*i;return{barWidth:i,offset:o}}const Oa=()=>{const t=pn()??{series:{},stackingGroups:[],seriesOrder:[]},e=ut(),s=be(),{series:i,stackingGroups:o}=t,{xAxis:n,yAxis:r,xAxisIds:l,yAxisIds:c}=e,d=l[0],g=c[0],u={};return{completedData:o.flatMap(({ids:f},h)=>f.flatMap(x=>{const y=i[x].xAxisId??i[x].xAxisKey??d,v=i[x].yAxisId??i[x].yAxisKey??g,b=n[y],_=r[v],C=i[x].layout==="vertical";Ba(C,x,y,n,v,r);const k=C?b:_,S=b.scale,M=_.scale,T=gn(i[x],n[y],r[v]),w=k.scale.bandwidth(),{barWidth:P,offset:E}=Ha({bandWidth:w,numberOfGroups:o.length,gapRatio:k.barGapRatio}),R=h*(P+E),{stackedData:N}=i[x];return N.map((A,I)=>{var K,G;const D=A.map(et=>C?M(et):S(et)),z=Math.round(Math.min(...D)),O=Math.round(Math.max(...D)),tt=i[x].stack,B={seriesId:x,dataIndex:I,layout:i[x].layout,x:C?S((K=n[y].data)==null?void 0:K[I])+R:z,y:C?z:M((G=r[v].data)==null?void 0:G[I])+R,xOrigin:S(0),yOrigin:M(0),height:C?O-z:P,width:C?P:O-z,color:T(I),value:i[x].data[I],maskId:`${s}_${tt||x}_${h}_${I}`};u[B.maskId]||(u[B.maskId]={id:B.maskId,width:0,height:0,hasNegative:!1,hasPositive:!1,layout:B.layout,xOrigin:S(0),yOrigin:M(0),x:0,y:0});const L=u[B.maskId];return L.width=B.layout==="vertical"?B.width:L.width+B.width,L.height=B.layout==="vertical"?L.height+B.height:B.height,L.x=Math.min(L.x===0?1/0:L.x,B.x),L.y=Math.min(L.y===0?1/0:L.y,B.y),L.hasNegative=L.hasNegative||(B.value??0)<0,L.hasPositive=L.hasPositive||(B.value??0)>0,B})})),masksData:Object.values(u)}},At=({layout:t,yOrigin:e,x:s,width:i,y:o,xOrigin:n,height:r})=>j({},t==="vertical"?{y:e,x:s,height:0,width:i}:{y:o,x:n,height:r,width:0}),Pt=({x:t,width:e,y:s,height:i})=>({y:s,x:t,height:i,width:e});function Ga(t){const{completedData:e,masksData:s}=Oa(),{skipAnimation:i,onItemClick:o,borderRadius:n,barLabel:r}=t,l=H(t,Fa),c=Dt(i),d=!n||n<=0,g=ft(e,{keys:p=>`${p.seriesId}-${p.dataIndex}`,from:At,leave:At,enter:Pt,update:Pt,immediate:c}),u=ft(d?[]:s,{keys:p=>p.id,from:At,leave:At,enter:Pt,update:Pt,immediate:c});return a.jsxs(m.Fragment,{children:[!d&&u((p,{id:f,hasPositive:h,hasNegative:x,layout:y})=>a.jsx(Pa,{maskId:f,borderRadius:n,hasNegative:x,hasPositive:h,layout:y,style:p})),g((p,{seriesId:f,dataIndex:h,color:x,maskId:y})=>{const v=a.jsx(Ca,j({id:f,dataIndex:h,color:x},l,{onClick:o&&(b=>{o(b,{type:"bar",seriesId:f,dataIndex:h})}),style:p}));return d?v:a.jsx("g",{clipPath:`url(#${y})`,children:v})}),r&&a.jsx(za,j({bars:e,skipAnimation:c,barLabel:r},l))]})}const Wa=["xAxis","yAxis","series","width","height","margin","colors","dataset","sx","tooltip","onAxisClick","axisHighlight","legend","grid","topAxis","leftAxis","rightAxis","bottomAxis","children","slots","slotProps","skipAnimation","loading","layout","onItemClick","highlightedItem","onHighlightChange","borderRadius","barLabel","className"],Ua=t=>{const{xAxis:e,yAxis:s,series:i,width:o,height:n,margin:r,colors:l,dataset:c,sx:d,tooltip:g,onAxisClick:u,axisHighlight:p,legend:f,grid:h,topAxis:x,leftAxis:y,rightAxis:v,bottomAxis:b,children:_,slots:C,slotProps:k,skipAnimation:S,loading:M,layout:T,onItemClick:w,highlightedItem:P,onHighlightChange:E,borderRadius:R,barLabel:N,className:A}=t,I=H(t,Wa),z=`${We()}-clip-path`,O=T==="horizontal"||T===void 0&&i.some(rt=>rt.layout==="horizontal"),tt={scaleType:"band",data:Array.from({length:Math.max(...i.map(rt=>(rt.data??c??[]).length))},(rt,qt)=>qt)},B=j({},I,{series:i.map(rt=>j({type:"bar"},rt,{layout:O?"horizontal":"vertical"})),width:o,height:n,margin:r,colors:l,dataset:c,xAxis:e??(O?void 0:[j({id:vt},tt)]),yAxis:s??(O?[j({id:Ye},tt)]:void 0),sx:d,highlightedItem:P,onHighlightChange:E,disableAxisListener:(g==null?void 0:g.trigger)!=="axis"&&(p==null?void 0:p.x)==="none"&&(p==null?void 0:p.y)==="none"&&!u,className:A,skipAnimation:S}),L={onItemClick:w,slots:C,slotProps:k,borderRadius:R,barLabel:N},K={onAxisClick:u},G={vertical:h==null?void 0:h.vertical,horizontal:h==null?void 0:h.horizontal},et={clipPath:`url(#${z})`},ht={id:z},Ut={slots:C,slotProps:k,loading:M},Kt={topAxis:x,leftAxis:y,rightAxis:v,bottomAxis:b,slots:C,slotProps:k},Xt=j({},O?{y:"band"}:{x:"band"},p),Yt=j({},f,{slots:C,slotProps:k}),Vt=j({},g,{slots:C,slotProps:k});return{chartContainerProps:B,barPlotProps:L,axisClickHandlerProps:K,gridProps:G,clipPathProps:ht,clipPathGroupProps:et,overlayProps:Ut,chartsAxisProps:Kt,axisHighlightProps:Xt,legendProps:Yt,tooltipProps:Vt,children:_}},Wt=m.forwardRef(function(e,s){const i=Ht({props:e,name:"MuiBarChart"}),{chartContainerProps:o,barPlotProps:n,axisClickHandlerProps:r,gridProps:l,clipPathProps:c,clipPathGroupProps:d,overlayProps:g,chartsAxisProps:u,axisHighlightProps:p,legendProps:f,tooltipProps:h,children:x}=Ua(i);return a.jsxs(Ve,j({ref:s},o,{children:[i.onAxisClick&&a.jsx(vs,j({},r)),a.jsx(_s,j({},l)),a.jsxs("g",j({},d,{children:[a.jsx(Ga,j({},n)),a.jsx(qe,j({},g)),a.jsx(Qe,j({},p))]})),a.jsx(Je,j({},u)),a.jsx(Ze,j({},f)),!i.loading&&a.jsx(ts,j({},h)),a.jsx(bs,j({},c)),x]}))});function Ka(t){const e=m.useRef({currentPath:t,previousPath:void 0});return e.current.currentPath!==t&&(e.current={currentPath:t,previousPath:e.current.currentPath}),e.current}const Cs=t=>{const e=Ka(t);return m.useMemo(()=>e.previousPath?xn(e.previousPath,e.currentPath):()=>e.currentPath,[e.currentPath,e.previousPath])};function js(t){return t.replace(" ","_")}function ks(t){const e=yt(),s=be(),i=ft([e],{from:n=>({animatedWidth:n.left}),enter:n=>({animatedWidth:n.width+n.left+n.right}),leave:n=>({animatedWidth:n.width+n.left+n.right}),reset:!1,immediate:t.skipAnimation}),o=js(`${s}-${t.id}`);return a.jsxs(m.Fragment,{children:[a.jsx("clipPath",{id:o,children:i(n=>a.jsx(ct.rect,{x:0,y:0,width:n.animatedWidth,height:e.top+e.height+e.bottom}))}),a.jsx("g",{clipPath:`url(#${o})`,children:t.children})]})}const Xa=["d","skipAnimation","ownerState"],Ya=V(ct.path,{name:"MuiAreaElement",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>({stroke:"none",fill:t.gradientId&&`url(#${t.gradientId})`||t.isHighlighted&&It(t.color).brighter(1).formatHex()||It(t.color).brighter(.5).formatHex(),transition:"opacity 0.2s ease-in, fill 0.2s ease-in",opacity:t.isFaded?.3:1}));function Va(t){const{d:e,skipAnimation:s,ownerState:i}=t,o=H(t,Xa),n=Cs(e),r=ft([n],{from:{value:0},to:{value:1},enter:{value:1},reset:!1,immediate:s});return a.jsx(ks,{skipAnimation:s,id:`${i.id}-area-clip`,children:r((l,c)=>a.jsx(Ya,j({},o,{ownerState:i,d:l.value.to(c)})))})}const qa=["id","classes","color","gradientId","slots","slotProps","onClick"];function Qa(t){return at("MuiAreaElement",t)}it("MuiAreaElement",["root","highlighted","faded"]);const Ja=t=>{const{classes:e,id:s,isFaded:i,isHighlighted:o}=t,n={root:["root",`series-${s}`,o&&"highlighted",i&&"faded"]};return ot(n,Qa,e)};function Za(t){const{id:e,classes:s,color:i,gradientId:o,slots:n,slotProps:r,onClick:l}=t,c=H(t,qa),d=_t(),{isFaded:g,isHighlighted:u}=bt({seriesId:e}),p={id:e,classes:s,color:i,gradientId:o,isFaded:g,isHighlighted:u},f=Ja(p),h=(n==null?void 0:n.area)??Va,x=Ft({elementType:h,externalSlotProps:r==null?void 0:r.area,additionalProps:j({},d({type:"line",seriesId:e}),{onClick:l,cursor:l?"pointer":"unset"}),className:f.root,ownerState:p});return a.jsx(h,j({},c,x))}function As(t){switch(t){case"catmullRom":return oa.alpha(.5);case"linear":return fe;case"monotoneX":return Ie;case"monotoneY":return ra;case"natural":return la;case"step":return ca;case"stepBefore":return da;case"stepAfter":return ua;default:return Ie}}const ti=["slots","slotProps","onItemClick","skipAnimation"],ei=()=>{const t=zt(),e=ut();return m.useMemo(()=>{if(t===void 0)return[];const{series:i,stackingGroups:o}=t,{xAxis:n,yAxis:r,xAxisIds:l,yAxisIds:c}=e,d=l[0],g=c[0];return o.flatMap(({ids:u})=>[...u].reverse().map(p=>{const{xAxisId:f,yAxisId:h,xAxisKey:x=d,yAxisKey:y=g,stackedData:v,data:b,connectNulls:_,baseline:C}=i[p],k=f??x,S=h??y,M=Bt(n[k].scale),T=r[S].scale,w=n[k].data,P=r[S].colorScale&&[S,"y"]||n[k].colorScale&&[k,"x"]||void 0,E=Un().x(D=>M(D.x)).defined((D,z)=>_||b[z]!=null).y0(D=>{if(typeof C=="number")return T(C);if(C==="max")return T.range()[1];if(C==="min")return T.range()[0];const z=D.y&&T(D.y[0]);return Number.isNaN(z)?T.range()[0]:z}).y1(D=>D.y&&T(D.y[1])),R=As(i[p].curve),N=(w==null?void 0:w.map((D,z)=>({x:D,y:v[z]})))??[],A=_?N.filter((D,z)=>b[z]!=null):N,I=E.curve(R)(A)||"";return j({},i[p],{gradientUsed:P,d:I,seriesId:p})}))},[t,e])};function si(t){const{slots:e,slotProps:s,onItemClick:i,skipAnimation:o}=t,n=H(t,ti),r=Dt(o),l=es(),c=ei();return a.jsx("g",j({},n,{children:c.map(({d,seriesId:g,color:u,area:p,gradientUsed:f})=>!!p&&a.jsx(Za,{id:g,d,color:u,gradientId:f&&l(...f),slots:e,slotProps:s,onClick:i&&(h=>i(h,{type:"line",seriesId:g})),skipAnimation:r},g))}))}const ni=["d","skipAnimation","ownerState"],ai=V(ct.path,{name:"MuiLineElement",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>({strokeWidth:2,strokeLinejoin:"round",fill:"none",stroke:t.gradientId&&`url(#${t.gradientId})`||t.isHighlighted&&It(t.color).brighter(.5).formatHex()||t.color,transition:"opacity 0.2s ease-in, stroke 0.2s ease-in",opacity:t.isFaded?.3:1}));function ii(t){const{d:e,skipAnimation:s,ownerState:i}=t,o=H(t,ni),n=Cs(e),r=ft([n],{from:{value:0},to:{value:1},enter:{value:1},reset:!1,immediate:s});return a.jsx(ks,{skipAnimation:s,id:`${i.id}-line-clip`,children:r((l,c)=>a.jsx(ai,j({},o,{ownerState:i,d:l.value.to(c)})))})}const oi=["id","classes","color","gradientId","slots","slotProps","onClick"];function ri(t){return at("MuiLineElement",t)}it("MuiLineElement",["root","highlighted","faded"]);const li=t=>{const{classes:e,id:s,isFaded:i,isHighlighted:o}=t,n={root:["root",`series-${s}`,o&&"highlighted",i&&"faded"]};return ot(n,ri,e)};function ci(t){const{id:e,classes:s,color:i,gradientId:o,slots:n,slotProps:r,onClick:l}=t,c=H(t,oi),d=_t(),{isFaded:g,isHighlighted:u}=bt({seriesId:e}),p={id:e,classes:s,color:i,gradientId:o,isFaded:g,isHighlighted:u},f=li(p),h=(n==null?void 0:n.line)??ii,x=Ft({elementType:h,externalSlotProps:r==null?void 0:r.line,additionalProps:j({},d({type:"line",seriesId:e}),{onClick:l,cursor:l?"pointer":"unset"}),className:f.root,ownerState:p});return a.jsx(h,j({},c,x))}const di=["slots","slotProps","skipAnimation","onItemClick"],ui=()=>{const t=zt(),e=ut();return m.useMemo(()=>{if(t===void 0)return[];const{series:i,stackingGroups:o}=t,{xAxis:n,yAxis:r,xAxisIds:l,yAxisIds:c}=e,d=l[0],g=c[0];return o.flatMap(({ids:u})=>u.flatMap(p=>{const{xAxisId:f,yAxisId:h,xAxisKey:x=d,yAxisKey:y=g,stackedData:v,data:b,connectNulls:_}=i[p],C=f??x,k=h??y,S=Bt(n[C].scale),M=r[k].scale,T=n[C].data,w=r[k].colorScale&&[k,"y"]||n[C].colorScale&&[C,"x"]||void 0,P=ds().x(A=>S(A.x)).defined((A,I)=>_||b[I]!=null).y(A=>M(A.y[1])),E=(T==null?void 0:T.map((A,I)=>({x:A,y:v[I]})))??[],R=_?E.filter((A,I)=>b[I]!=null):E,N=P.curve(As(i[p].curve))(R)||"";return j({},i[p],{gradientUsed:w,d:N,seriesId:p})}))},[t,e])};function hi(t){const{slots:e,slotProps:s,skipAnimation:i,onItemClick:o}=t,n=H(t,di),r=Dt(i),l=es(),c=ui();return a.jsx("g",j({},n,{children:c.map(({d,seriesId:g,color:u,gradientUsed:p})=>a.jsx(ci,{id:g,d,color:u,gradientId:p&&l(...p),skipAnimation:r,slots:e,slotProps:s,onClick:o&&(f=>o(f,{type:"line",seriesId:g}))},g))}))}function pi(t){return at("MuiMarkElement",t)}it("MuiMarkElement",["root","highlighted","faded"]);const Ps=t=>{const{classes:e,id:s,isFaded:i,isHighlighted:o}=t,n={root:["root",`series-${s}`,o&&"highlighted",i&&"faded"]};return ot(n,pi,e)},gi=["x","y","id","classes","color","dataIndex","onClick","skipAnimation","shape"];function xi(t){var _;const{x:e,y:s,id:i,classes:o,color:n,dataIndex:r,onClick:l,skipAnimation:c,shape:d}=t,g=H(t,gi),u=mn(),p=_t(),{isFaded:f,isHighlighted:h}=bt({seriesId:i}),{axis:x}=m.useContext(Nt),y=ss({to:{x:e,y:s},immediate:c}),v={id:i,classes:o,isHighlighted:((_=x.x)==null?void 0:_.index)===r||h,isFaded:f,color:n},b=Ps(v);return a.jsx(ct.circle,j({},g,{cx:y.x,cy:y.y,r:5,fill:(u.vars||u).palette.background.paper,stroke:n,strokeWidth:2,className:b.root,onClick:l,cursor:l?"pointer":"unset"},p({type:"line",seriesId:i,dataIndex:r})))}function fi(t){return"circle cross diamond square star triangle wye".split(/ /).indexOf(t)||0}const mi=["x","y","id","classes","color","shape","dataIndex","onClick","skipAnimation"],bi=V(ct.path,{name:"MuiMarkElement",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t,theme:e})=>({fill:(e.vars||e).palette.background.paper,stroke:t.color,strokeWidth:2}));function yi(t){var b;const{x:e,y:s,id:i,classes:o,color:n,shape:r,dataIndex:l,onClick:c,skipAnimation:d}=t,g=H(t,mi),u=_t(),{isFaded:p,isHighlighted:f}=bt({seriesId:i}),{axis:h}=m.useContext(Nt),x=ss({to:{x:e,y:s},immediate:d}),y={id:i,classes:o,isHighlighted:((b=h.x)==null?void 0:b.index)===l||f,isFaded:p,color:n},v=Ps(y);return a.jsx(bi,j({},g,{style:{transform:je([x.x,x.y],(_,C)=>`translate(${_}px, ${C}px)`),transformOrigin:je([x.x,x.y],(_,C)=>`${_}px ${C}px`)},ownerState:y,className:v.root,d:aa(na[fi(r)])(),onClick:c,cursor:c?"pointer":"unset"},u({type:"line",seriesId:i,dataIndex:l})))}const _i=["slots","slotProps","skipAnimation","onItemClick","experimentalRendering"];function vi(t){const{slots:e,slotProps:s,skipAnimation:i,onItemClick:o,experimentalRendering:n}=t,r=H(t,_i),l=Dt(i),c=zt(),d=ut(),g=be(),u=yt(),p=(e==null?void 0:e.mark)??(n?xi:yi);if(c===void 0)return null;const{series:f,stackingGroups:h}=c,{xAxis:x,yAxis:y,xAxisIds:v,yAxisIds:b}=d,_=v[0],C=b[0];return a.jsx("g",j({},r,{children:h.flatMap(({ids:k})=>k.map(S=>{const{xAxisId:M,yAxisId:T,xAxisKey:w=_,yAxisKey:P=C,stackedData:E,data:R,showMark:N=!0}=f[S];if(N===!1)return null;const A=M??w,I=T??P,D=Bt(x[A].scale),z=y[I].scale,O=x[A].data;if(O===void 0)throw new Error(`MUI X: ${A===vt?"The first `xAxis`":`The x-axis with id "${A}"`} should have data property to be able to display a line plot.`);const tt=js(`${g}-${S}-line-clip`),B=ns(f[S],x[A],y[I]);return a.jsx("g",{clipPath:`url(#${tt})`,children:O==null?void 0:O.map((L,K)=>{const G=R[K]==null?null:E[K][1];return{x:D(L),y:G===null?null:z(G),position:L,value:G,index:K}}).filter(({x:L,y:K,index:G,position:et,value:ht})=>ht===null||K===null||!u.isPointInside({x:L,y:K})?!1:N===!0?!0:N({x:L,y:K,index:G,position:et,value:ht})).map(({x:L,y:K,index:G})=>a.jsx(p,j({id:S,dataIndex:G,shape:"circle",color:B(G),x:L,y:K,skipAnimation:l,onClick:o&&(et=>o(et,{type:"line",seriesId:S,dataIndex:G}))},s==null?void 0:s.mark),`${S}-${G}`))},S)}))}))}const Ci=["x","y","id","classes","color"];function ji(t){return at("MuiHighlightElement",t)}it("MuiHighlightElement",["root"]);const ki=t=>{const{classes:e,id:s}=t,i={root:["root",`series-${s}`]};return ot(i,ji,e)},Ai=V("circle",{name:"MuiHighlightElement",slot:"Root",overridesResolver:(t,e)=>e.root})(({ownerState:t})=>({transform:`translate(${t.x}px, ${t.y}px)`,transformOrigin:`${t.x}px ${t.y}px`,fill:t.color}));function Pi(t){const{x:e,y:s,id:i,classes:o,color:n}=t,r=H(t,Ci),l={id:i,classes:o,color:n,x:e,y:s},c=ki(l);return a.jsx(Ai,j({pointerEvents:"none",ownerState:l,className:c.root,cx:0,cy:0,r:r.r===void 0?5:r.r},r))}const Si=["slots","slotProps"];function wi(t){var b;const{slots:e,slotProps:s}=t,i=H(t,Si),o=zt(),n=ut(),r=yt(),{axis:l}=m.useContext(Nt),c=(b=l.x)==null?void 0:b.index;if(c===void 0||o===void 0)return null;const{series:d,stackingGroups:g}=o,{xAxis:u,yAxis:p,xAxisIds:f,yAxisIds:h}=n,x=f[0],y=h[0],v=(e==null?void 0:e.lineHighlight)??Pi;return a.jsx("g",j({},i,{children:g.flatMap(({ids:_})=>_.flatMap(C=>{const{xAxisId:k,yAxisId:S,xAxisKey:M=x,yAxisKey:T=y,stackedData:w,data:P,disableHighlight:E}=d[C],R=k??M,N=S??T;if(E||P[c]==null)return null;const A=Bt(u[R].scale),I=p[N].scale,D=u[R].data;if(D===void 0)throw new Error(`MUI X: ${R===vt?"The first `xAxis`":`The x-axis with id "${R}"`} should have data property to be able to display a line plot.`);const z=A(D[c]),O=I(w[c][1]);if(!r.isPointInside({x:z,y:O}))return null;const tt=ns(d[C],u[R],p[N]);return a.jsx(v,j({id:C,color:tt(c),x:z,y:O},s==null?void 0:s.lineHighlight),`${C}`)}))}))}const Ii=["xAxis","yAxis","series","width","height","margin","colors","dataset","sx","tooltip","onAxisClick","onAreaClick","onLineClick","onMarkClick","axisHighlight","disableLineItemHighlight","legend","grid","topAxis","leftAxis","rightAxis","bottomAxis","children","slots","slotProps","skipAnimation","loading","highlightedItem","onHighlightChange","className","experimentalMarkRendering"],Mi=t=>{const{xAxis:e,yAxis:s,series:i,width:o,height:n,margin:r,colors:l,dataset:c,sx:d,tooltip:g,onAxisClick:u,onAreaClick:p,onLineClick:f,onMarkClick:h,axisHighlight:x,disableLineItemHighlight:y,legend:v,grid:b,topAxis:_,leftAxis:C,rightAxis:k,bottomAxis:S,children:M,slots:T,slotProps:w,skipAnimation:P,loading:E,highlightedItem:R,onHighlightChange:N,className:A,experimentalMarkRendering:I}=t,D=H(t,Ii),O=`${We()}-clip-path`,tt=j({},D,{series:i.map(Ct=>j({disableHighlight:!!y,type:"line"},Ct)),width:o,height:n,margin:r,colors:l,dataset:c,xAxis:e??[{id:vt,scaleType:"point",data:Array.from({length:Math.max(...i.map(Ct=>(Ct.data??c??[]).length))},(Ct,Ts)=>Ts)}],yAxis:s,sx:d,highlightedItem:R,onHighlightChange:N,disableAxisListener:(g==null?void 0:g.trigger)!=="axis"&&(x==null?void 0:x.x)==="none"&&(x==null?void 0:x.y)==="none"&&!u,className:A,skipAnimation:P}),B={onAxisClick:u},L={vertical:b==null?void 0:b.vertical,horizontal:b==null?void 0:b.horizontal},K={clipPath:`url(#${O})`},G={id:O},et={slots:T,slotProps:w,onItemClick:p},ht={slots:T,slotProps:w,onItemClick:f},Ut={slots:T,slotProps:w,onItemClick:h,skipAnimation:P,experimentalRendering:I},Kt={slots:T,slotProps:w,loading:E},Xt={topAxis:_,leftAxis:C,rightAxis:k,bottomAxis:S,slots:T,slotProps:w},Yt=j({x:"line"},x),Vt={slots:T,slotProps:w},rt=j({},v,{slots:T,slotProps:w}),qt=j({},g,{slots:T,slotProps:w});return{chartContainerProps:tt,axisClickHandlerProps:B,gridProps:L,clipPathProps:G,clipPathGroupProps:K,areaPlotProps:et,linePlotProps:ht,markPlotProps:Ut,overlayProps:Kt,chartsAxisProps:Xt,axisHighlightProps:Yt,lineHighlightPlotProps:Vt,legendProps:rt,tooltipProps:qt,children:M}},Ti=m.forwardRef(function(e,s){const i=Ht({props:e,name:"MuiLineChart"}),{chartContainerProps:o,axisClickHandlerProps:n,gridProps:r,clipPathProps:l,clipPathGroupProps:c,areaPlotProps:d,linePlotProps:g,markPlotProps:u,overlayProps:p,chartsAxisProps:f,axisHighlightProps:h,lineHighlightPlotProps:x,legendProps:y,tooltipProps:v,children:b}=Mi(i);return a.jsxs(Ve,j({ref:s},o,{children:[i.onAxisClick&&a.jsx(vs,j({},n)),a.jsx(_s,j({},r)),a.jsxs("g",j({},c,{children:[a.jsx(si,j({},d)),a.jsx(hi,j({},g)),a.jsx(qe,j({},p)),a.jsx(Qe,j({},h))]})),a.jsx(Je,j({},f)),a.jsx("g",{"data-drawing-container":!0,children:a.jsx(vi,j({},u))}),a.jsx(wi,j({},x)),a.jsx(Ze,j({},y)),!i.loading&&a.jsx(ts,j({},v)),a.jsx(bs,j({},l)),b]}))}),Ei=()=>m.useRef({}),$i="#e8f0fe",Li="#444",Ri="#008297",Ni="rgb(174, 37, 174)",Di="#dfe5e8",zi="_wizard_hrbk1_3",Bi="_controls_hrbk1_13",Fi="_widgetColumn_hrbk1_24",Hi="_controlsContainer_hrbk1_31",Oi="_imageGrid_hrbk1_39",Gi="_workspace_hrbk1_53",Wi="_container_hrbk1_62",Ui="_svglayer_hrbk1_91",Ki="_menuLogo_hrbk1_98",Xi="_menuLogoSmall_hrbk1_108",Yi="_clusterContainer_hrbk1_118",Vi="_group_hrbk1_126",qi="_clusterGroup_hrbk1_136",Qi="_pointSvg_hrbk1_144",Ji="_imageTags_hrbk1_150",Zi="_imageContainer_hrbk1_160",$={bgSubdued1:$i,textDark:Li,primary:Ri,secondary:Ni,workspaceBg:Di,wizard:zi,controls:Bi,widgetColumn:Fi,controlsContainer:Hi,imageGrid:Oi,workspace:Gi,container:Wi,svglayer:Ui,menuLogo:Ki,menuLogoSmall:Xi,clusterContainer:Yi,group:Vi,clusterGroup:qi,pointSvg:Qi,imageTags:Ji,imageContainer:Zi};async function to(t,e){return await(await fetch("https://pixabay.com/api/?"+new URLSearchParams({key:{}.VITE_PIXABAY_KEY,q:t,image_type:"photo",safesearch:"true",order:(e==null?void 0:e.order)||"latest",per_page:`${(e==null?void 0:e.perPage)||20}`,page:`${(e==null?void 0:e.page)||1}`}))).json()}async function eo(t,e){return await(await(t?fetch("https://api.pexels.com/v1/search?"+new URLSearchParams({query:t,per_page:`${(e==null?void 0:e.perPage)||20}`,page:`${(e==null?void 0:e.page)||1}`}),{headers:new Headers({Authorization:{}.VITE_PEXELS_KEY})}):fetch("https://api.pexels.com/v1/curated?"+new URLSearchParams({per_page:`${(e==null?void 0:e.perPage)||20}`,page:`${(e==null?void 0:e.page)||1}`}),{headers:new Headers({Authorization:{}.VITE_PEXELS_KEY})}))).json()}const so={total:0,pages:0,results:[]};async function Ss(t,e,s,i){if(t){if(s==="pixabay")return to(t,{page:e,perPage:20,order:i}).then(o=>({total:o.totalHits,pages:Math.ceil(o.totalHits/20),results:o.hits.map(n=>({url:n.webformatURL,author:n.user,tags:n.tags.split(",").map(r=>r.trim()),id:`pixabay-${n.id}`,width:n.webformatWidth,height:n.webformatHeight}))}));if(s==="pexels")return eo(t,{page:e,perPage:40}).then(o=>({total:o.total_results,pages:Math.ceil(o.total_results/40),results:o.photos.map(n=>({url:n.src.large,author:n.photographer,tags:[],id:`pexels-${n.id}`,width:n.width,height:n.height}))}))}}function no(t,e){const[s,i]=m.useState(so),o=(e==null?void 0:e.source)||"pixabay",n=(e==null?void 0:e.page)||0;return m.useEffect(()=>{t&&Ss(t,n,o,(e==null?void 0:e.order)||"latest").then(r=>{r&&i(r)})},[t,o,n,e==null?void 0:e.order]),s}async function ao(t,e,s,i,o,n,r,l,c,d){const g=await Ss(s,i,o,n);if(g){let u=r;const p=g.results.map(async f=>{if(t.hasContent(`content:${f.id}`)||e.has(`content:${f.id}`)||u>=l)return;const h={id:f.id,labels:f.tags.map(x=>({label:x,weight:1})),author:f.author};if(!(c&&!c(h)))return oe(f.url,500).then(x=>{const y=x.toDataURL("image/jpeg",.95);d&&!d(y)||u>=l||(u+=1,e.add(`content:${f.id}`),t.addContent(y,h))})});return Promise.all(p).then(()=>u)}else return r}function io(t,e){return t.labels.findIndex(s=>e.has(s.label))>=0}const oo=100;function ro({tags:t,onClose:e,open:s,query:i,options:o}){const{t:n}=W(),[r,l]=m.useState(50),[c,d]=m.useState(!1),[g,u]=m.useState(0),p=U(),[f,h]=m.useState(0),x=m.useRef(new Set);m.useEffect(()=>{s&&(l(50),h(0))},[s]);const y=g===0&&f>=r;m.useEffect(()=>{if(g>0&&f<r){const b=new Set(t);ao(p,x.current,i,g,(o==null?void 0:o.source)||"pixabay",(o==null?void 0:o.order)||"latest",f,r,_=>t?io(_,b):!0).then(_=>{setTimeout(()=>{h(_),_<r&&g<oo?u(C=>C+1):(u(0),d(!1))},500)})}},[g,i,o,f,p,r,t]),m.useEffect(()=>{c&&(h(0),u(1))},[c]);const v=f/r;return a.jsxs(re,{open:s,onClose:e,maxWidth:"xs",children:[a.jsx(ce,{children:n("creator.titles.captureImages")}),a.jsxs(le,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:"1rem"},children:[(g>0||y)&&a.jsxs(a.Fragment,{children:[!y&&a.jsx(Ls,{}),v!==void 0&&a.jsx(Vs,{sx:{width:"100%"},variant:"determinate",value:Math.round(v*100)})]}),g===0&&!y&&a.jsxs(a.Fragment,{children:[a.jsx("div",{id:"number-of-images-label",className:$.label,children:n("creator.labels.numberOfImages")}),a.jsx(st,{"aria-labelledby":"number-of-images-label",value:r,onChange:(b,_)=>l(_),min:10,max:1e3,step:10,valueLabelDisplay:"auto"})]})]}),a.jsxs(Be,{children:[a.jsx(lt,{disabled:g>0||y,variant:"contained",onClick:()=>d(!0),children:n("creator.actions.add")}),a.jsx(lt,{variant:"outlined",onClick:e,children:n("creator.actions.close")})]})]})}function lo({disabled:t}){const{t:e}=W(),s=m.useRef(),[i,o]=m.useState(),[n,r]=m.useState("latest"),[l,c]=m.useState([]),d=no(i,{page:1,source:"pixabay",order:n}),g=U(),[u,p]=m.useState(!1),f=m.useCallback(x=>{if(x.key==="Enter"){const y=x.target.value;y.length>=2&&o(y)}},[]),h=m.useCallback(()=>{var y;const x=(y=s.current)==null?void 0:y.value;x&&x.length>=2&&o(x)},[]);return m.useEffect(()=>{c([]),d.results.forEach(x=>{g.hasContent(`content:${x.id}`)||oe(x.url,500).then(y=>{const v=y.toDataURL("image/jpeg",.95);c(b=>[...b,v])})})},[d,g]),a.jsxs("div",{style:{padding:"1rem"},children:[a.jsx("div",{className:$.controlsContainer,children:a.jsxs("div",{className:$.controls,children:[a.jsx(Tt,{disabled:t,label:e("creator.labels.search"),type:"search",variant:"outlined",onKeyDown:f,inputRef:s,InputProps:{startAdornment:a.jsx(de,{position:"start",children:a.jsx(Xs,{})})}}),a.jsx(lt,{variant:"contained",onClick:h,disabled:t,children:e("creator.actions.go")})]})}),a.jsx("div",{className:$.controlsContainer,children:a.jsx("div",{className:$.controls,children:a.jsxs(Zs,{sx:{flexDirection:"row",gap:"1rem"},defaultValue:"latest",name:"radio-buttons-group",value:n,onChange:(x,y)=>{r(y)},children:[a.jsx(xt,{value:"latest",control:a.jsx(ye,{}),label:e("creator.labels.latest"),disabled:t}),a.jsx(xt,{value:"popular",control:a.jsx(ye,{}),label:e("creator.labels.popular"),disabled:t})]})})}),a.jsx("div",{className:$.imageGrid,children:l.map((x,y)=>a.jsx("img",{src:x,alt:"",width:80,height:80},y))}),a.jsx(Re,{variant:"contained",disabled:t||!i,onClick:()=>p(!0),color:"secondary",children:e("creator.actions.addImages")}),a.jsx(ro,{open:u,onClose:()=>p(!1),query:i||"",options:{order:n,source:"pixabay"},onComplete:()=>{}})]})}async function co(t,e){e.forEach(s=>{const n={id:(s.name.split(/[\\/]+/i).pop()||s.name).split(".")[0],labels:[],author:Rs()};Ys(s,500).then(r=>{const l=r.toDataURL("image/jpeg",.95);t.addContent(l,n)})})}function uo(){const{t}=W(),e=U(),s=m.useRef(null);return a.jsxs("div",{style:{padding:"1rem",display:"flex",flexDirection:"column",gap:"1rem"},children:[a.jsx("input",{type:"file",multiple:!0,ref:s,accept:".png,.jpg,.jpeg"}),a.jsx(Re,{variant:"contained",onClick:()=>{s.current&&(co(e,Array.from(s.current.files||[])),s.current.value="")},color:"secondary",children:t("creator.actions.addImages")})]})}function ho({disabled:t}){const{t:e}=W(),[s,i]=m.useState(0);return a.jsxs(J,{title:e("creator.titles.query"),dataWidget:"query",style:{maxWidth:"500px"},noPadding:!0,children:[a.jsxs(ue,{value:s,onChange:(o,n)=>i(n),children:[a.jsx(dt,{label:e("creator.titles.query")}),a.jsx(dt,{label:e("creator.titles.local")})]}),s===0&&a.jsx(lo,{disabled:t}),s===1&&a.jsx(uo,{})]})}function po(t,e){const s=new Set(e);t.getAllContent().forEach(o=>{const n=t.getContentMetadata(o);if(n)for(let r=0;r<n.labels.length;++r){const l=n.labels[r];if(s.has(l.label)){t.removeContent(o);break}}})}function go(t,e){const s=new Set(e);t.getAllContent().forEach(o=>{const n=t.getContentMetadata(o);if(n){for(let r=0;r<n.labels.length;++r){const l=n.labels[r];s.has(l.label)&&(l.label=e[0])}t.updateMeta(o,{labels:Ne(n.labels,r=>r.label)})}}),t.rebuildContent()}function xo(t,e,s){t.getAllContent().forEach(o=>{const n=t.getContentMetadata(o);if(n){for(let r=0;r<n.labels.length;++r){const l=n.labels[r];l.label===e&&(l.label=s)}t.updateMeta(o,{labels:Ne(n.labels,r=>r.label)})}}),t.rebuildContent()}function fo(t,e){const s=new Set(e);t.getAllContent().forEach(o=>{const n=t.getContentMetadata(o);n&&t.updateMeta(o,{labels:n.labels.filter(r=>!s.has(r.label))})}),t.rebuildContent()}const mo=[{field:"label",headerName:"Label",width:200,editable:!0},{field:"weight",headerName:"Count",width:80}];function bo(t,e){const s=new Map;e.forEach(o=>{const n=t.getContentMetadata(o);n&&n.labels.forEach(r=>{const l=s.get(r.label)||0;s.set(r.label,l+1)})});const i=Array.from(s).map(o=>({id:o[0],label:o[0],weight:o[1]}));return i.sort((o,n)=>n.weight-o.weight),i}function yo({onFindMore:t}){const{t:e}=W(),s=He("content"),i=U(),o=Ei(),n=m.useRef(null),[r,l]=m.useState(!1),c=mt(()=>bo(i,s),[i,s],"contentmeta"),d=m.useCallback(()=>{if(o.current){const f=o.current.getSelectedRows(),h=[];f.forEach(x=>{h.push(x.label)}),fo(i,h)}},[i,o]),g=m.useCallback(()=>{if(o.current){const f=o.current.getSelectedRows(),h=[];f.forEach(x=>{h.push(x.label)}),po(i,h)}},[i,o]),u=m.useCallback(()=>{if(o.current){const f=o.current.getSelectedRows(),h=[];f.forEach(x=>{h.push(x.label)}),go(i,h)}},[i,o]),p=m.useCallback(()=>{if(o.current&&t){const f=o.current.getSelectedRows(),h=[];f.forEach(x=>{h.push(x.label)}),t(h)}},[o,t]);return a.jsxs(J,{title:e("creator.titles.summary"),dataWidget:"summary",style:{maxWidth:"400px"},menu:a.jsxs("div",{children:[a.jsx(nt,{ref:n,onClick:()=>l(!0),children:a.jsx($t,{})}),a.jsxs(Et,{anchorEl:n.current,open:r,onClose:()=>l(!1),children:[a.jsx(Y,{onClick:d,children:e("creator.actions.deleteTags")}),a.jsx(Y,{onClick:g,children:e("creator.actions.deleteImagesWithTags")}),a.jsx(Y,{onClick:u,children:e("creator.actions.mergeTags")}),a.jsx(Y,{disabled:!t,onClick:p,children:e("creator.actions.findMoreTag")})]})]}),children:[a.jsx("div",{className:$.controlsContainer,children:a.jsx("div",{children:e("creator.labels.count",{count:s.length})})}),a.jsx(an,{apiRef:o,rows:c,columns:mo,checkboxSelection:!0,initialState:{pagination:{paginationModel:{pageSize:10,page:0}}},processRowUpdate:(f,h)=>(xo(i,h.label,f.label),f)})]})}const _o=he(a.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2M4 12c0-4.42 3.58-8 8-8 1.85 0 3.55.63 4.9 1.69L5.69 16.9C4.63 15.55 4 13.85 4 12m8 8c-1.85 0-3.55-.63-4.9-1.69L18.31 7.1C19.37 8.45 20 10.15 20 12c0 4.42-3.58 8-8 8"}),"Block");function vo(){const[t,e]=m.useReducer(d=>d+1,0),[s,i]=m.useState(),[o,n]=m.useState([]),[r,l]=m.useState([]),c=U();return Oe(()=>{e()},[],"refresh_embeddings"),m.useEffect(()=>{var b;const d=c.graph.getNodesByType("content"),g=Math.floor(Math.random()*d.length);i(d[g]);const u=((b=c.getContentMetadata(d[g]))==null?void 0:b.embedding)||[],p=[];d.forEach((_,C)=>{if(C===g)return;const k=c.getContentMetadata(_);if(k&&k.embedding){const S=De(u,k.embedding);p.push({id:_,weight:S})}}),p.sort((_,C)=>C.weight-_.weight);const f=30,h=new Array(f).fill(0),x=-1,v=1-x;p.forEach(_=>{const C=Math.floor((_.weight-x)/v*(f-1)+.5);h[C]+=1}),l(h.map((_,C)=>({x:Math.floor((C/f*2-1)*10),y:_}))),n(p.slice(0,8))},[t,c]),a.jsxs("div",{className:$.row,children:[a.jsx(Lt,{images:[s||"content:none",...o.map(d=>d.id)]}),a.jsx(Wt,{series:[{dataKey:"y"}],yAxis:[{min:0,max:r.reduce((d,g)=>Math.max(d,g.y),0)}],dataset:r,height:150,margin:{left:40,right:20,top:20,bottom:30},xAxis:[{scaleType:"band",dataKey:"x"}]})]})}const Co="#e8f0fe",jo="_statsTable_vxpjo_3",ko="_heading_vxpjo_15",$e={bgSubdued1:Co,statsTable:jo,heading:ko};function ws({stats:t}){const e=Object.keys(t);return a.jsx("table",{className:$e.statsTable,children:a.jsx("tbody",{children:e.map(s=>a.jsxs("tr",{children:[a.jsx("td",{className:$e.heading,children:s}),a.jsxs("td",{children:[" ",t[s]]})]},s))})})}function Is({data:t,maxEpochs:e}){const{t:s}=W(),i=t.length>0?t[t.length-1].epoch:0,o=t.length>0?t[t.length-1].loss:0,n=t.length>0?t[t.length-1].validationLoss:0,r=e||t.length+10;return a.jsxs("div",{children:[a.jsx(ws,{stats:{[s("creator.labels.epochs")]:i.toFixed(0),[s("creator.labels.loss")]:o.toFixed(3),[s("creator.labels.validationLoss")]:n.toFixed(3)}}),a.jsx(Ti,{margin:{left:40,right:20,top:20,bottom:30},skipAnimation:!0,height:250,dataset:t,xAxis:[{dataKey:"epoch",min:0,max:r}],series:[{dataKey:"validationLoss",showMark:!1}]})]})}function Ao(){const[t,e]=m.useReducer(n=>n+1,0),[s,i]=m.useState([]),o=U();return Oe(()=>{e()},[],"refresh_embeddings"),m.useEffect(()=>{const n=o.graph.getNodesByType("content"),r=30,l=new Array(r).fill(0),c=-1,g=1-c;n.forEach((u,p)=>{const f=o.getContentMetadata(u);f&&n.forEach((h,x)=>{if(x<=p)return;const y=o.getContentMetadata(h);if(y&&f.embedding&&y.embedding){const v=De(f.embedding,y.embedding),b=Math.floor((v-c)/g*(r-1)+.5);l[b]+=1}})}),i(l.map((u,p)=>({x:Math.floor((p/r*2-1)*10),y:u})))},[t,o]),a.jsx("div",{className:$.row,style:{padding:"1rem"},children:a.jsx(Wt,{series:[{dataKey:"y"}],yAxis:[{min:0,max:s.reduce((n,r)=>Math.max(n,r.y),0)}],dataset:s,height:150,margin:{left:40,right:20,top:20,bottom:30},xAxis:[{scaleType:"band",dataKey:"x"}]})})}function Po(){const{t}=W(),[e,s]=m.useState(100),[i,o]=m.useState(20),[n,r]=m.useState(!1),l=U(),[c,d]=m.useState(),g=He("content"),[u,p]=m.useState(!1),[f,h]=m.useState(!0),[x,y]=m.useState(!1),[v,b]=m.useState([]),[_,C]=m.useState(.001),[k,S]=m.useState(0),M=ie(Ot),T=rn("refresh_embeddings"),w=m.useMemo(()=>{if(!n)for(let P=0;P<g.length;++P){const E=l.getContentMetadata(g[P]);if(!E||!E.embedding)return!1}return!0},[l,g,n]);return m.useEffect(()=>{n&&(b([]),l.createEncoderModel({noEngagementFeatures:!x,noContentFeatures:!f,noTagFeatures:!u,layers:[128],loss:"cosineProximity",outputActivation:"linear",learningRate:_,epochs:e,dims:i,noSave:!1,onEpoch:(P,E,R)=>{b(N=>[...N,{epoch:P+1,loss:E,validationLoss:R}])}}).then(P=>{d(P),r(!1)}))},[n,l,e,i,f,u,x,_]),a.jsxs("div",{className:$.widgetColumn,"data-widget":"container",children:[a.jsxs(J,{title:t("creator.titles.similarity"),dataWidget:"similarity",style:{width:"350px",padding:"0"},noPadding:!0,menu:a.jsx("div",{children:a.jsx(nt,{onClick:T,children:a.jsx(bn,{})})}),children:[a.jsxs(ue,{value:k,onChange:(P,E)=>S(E),children:[a.jsx(dt,{label:t("creator.labels.imageSimilarity")}),a.jsx(dt,{label:t("creator.labels.similarityDistrib")})]}),k===0&&a.jsx(vo,{}),k===1&&a.jsx(Ao,{})]}),a.jsxs(J,{title:t("creator.titles.embedding"),dataWidget:"embed",style:{width:"300px"},children:[!w&&a.jsx(Ns,{severity:"info",children:t("creator.messages.needsRegen")}),M&&a.jsxs("div",{className:$.group,children:[a.jsx(xt,{disabled:n,control:a.jsx(St,{checked:u,onChange:(P,E)=>p(E)}),label:t("creator.labels.useLabels")}),a.jsx(xt,{disabled:n,control:a.jsx(St,{checked:f,onChange:(P,E)=>h(E)}),label:t("creator.labels.usePixels")}),a.jsx(xt,{disabled:n,control:a.jsx(St,{checked:x,onChange:(P,E)=>y(E)}),label:t("creator.labels.useEngagement")})]}),M&&a.jsxs("div",{className:$.group,children:[a.jsx("label",{id:"autoencoder-epoch-slider",children:t("creator.labels.epochs")}),a.jsx(st,{disabled:n,"aria-labelledby":"autoencoder-epoch-slider",value:e,onChange:(P,E)=>{s(E)},min:20,max:600,step:10,valueLabelDisplay:"auto"}),a.jsx("label",{id:"autoencoder-dim-slider",children:t("creator.labels.dimensions")}),a.jsx(st,{disabled:n,"aria-labelledby":"autoencoder-dim-slider",value:i,onChange:(P,E)=>{o(E)},min:4,max:32,step:2,valueLabelDisplay:"auto"}),a.jsx("label",{id:"autoencoder-rate-slider",children:t("creator.labels.learningRate")}),a.jsx(st,{disabled:n,"aria-labelledby":"autoencoder-rate-slider",value:_,onChange:(P,E)=>{C(E)},min:1e-4,max:.002,step:1e-4,valueLabelDisplay:"auto"})]}),a.jsxs("div",{className:$.group,style:{gap:"0.5rem"},children:[a.jsx(as,{variant:"contained",busy:n,onClick:()=>r(!0),children:t("creator.actions.generateEmbed")}),a.jsx(lt,{disabled:!c,variant:"outlined",onClick:()=>{c&&on.saveAs(c,"encoder.zip")},children:t("creator.actions.saveEncoder")})]})]}),M&&a.jsx(J,{title:t("creator.titles.embeddingTrain"),dataWidget:"similarity",style:{width:"300px",padding:"0"},children:a.jsx("div",{className:$.group,children:a.jsx(Is,{data:v,maxEpochs:e})})})]})}function So({clusters:t}){const e=U(),s=m.useMemo(()=>t.map((o,n)=>{const r=o.map(l=>{var c;return((c=e.getContentMetadata(l))==null?void 0:c.embedding)||[]});return{distance:Ds(r,r),size:o.length,id:`cluster-${n}`}}),[t,e]),i=s.reduce((o,n)=>Math.max(o,n.distance),0);return a.jsxs("div",{style:{width:"100%",padding:"1rem",boxSizing:"border-box"},children:[a.jsx(ws,{stats:{"Maximum Distance":i.toFixed(2),"Number of Clusters":`${t.length}`}}),a.jsx(Wt,{series:[{dataKey:"size"}],dataset:s,height:150,margin:{left:40,right:20,top:20,bottom:30}})]})}function wo({clusters:t,page:e,onPage:s}){const i=U(),o=mt(()=>{const n=t[e];if(!n)return[];const r=new Map;n.forEach(c=>{const d=i.getContentMetadata(c);d&&d.labels.forEach(g=>{r.set(g.label,(r.get(g.label)||0)+1)})});const l=Array.from(r).map(c=>({label:c[0].length>10?`${c[0].slice(0,10)}...`:c[0],count:c[1]}));return l.sort((c,d)=>d.count-c.count),l.slice(0,15)},[t,i,e],"contentmeta");return a.jsxs("div",{className:$.clusterGroup,children:[a.jsx(os,{count:t.length,page:e+1,onChange:(n,r)=>s(r-1)}),a.jsx(Wt,{layout:"horizontal",series:[{dataKey:"count"}],dataset:o,yAxis:[{dataKey:"label",scaleType:"band"}],height:300,margin:{left:100,right:20,top:20,bottom:30}})]})}const Io="_column_doth6_1",Mo={column:Io};function Ms({open:t,onClose:e,onAdd:s}){const{t:i}=W(),o=U(),[n,r]=m.useState(null),l=m.useRef(null),c=mt(()=>o.getAllLabels(),[o],"contentmeta");return a.jsxs(re,{open:t,onClose:e,children:[a.jsx(ce,{children:i("creator.titles.addTag")}),a.jsx(le,{children:a.jsx("div",{className:Mo.column,children:a.jsx(pe,{selectOnFocus:!0,sx:{width:"300px"},freeSolo:!0,value:n,onChange:(d,g)=>{r(g),g&&(s(g),e())},renderInput:d=>a.jsx(Tt,{...d,inputRef:l,label:i("creator.labels.addTag"),InputProps:{...d.InputProps,startAdornment:a.jsx(de,{position:"start",children:a.jsx(Fe,{})})}}),options:c})})}),a.jsxs(Be,{children:[a.jsx(lt,{variant:"contained",startIcon:a.jsx(ze,{}),onClick:()=>{var g;const d=((g=l.current)==null?void 0:g.value)||"";d.length>2&&(s(d),e())},children:i("creator.actions.add")}),a.jsx(lt,{variant:"outlined",onClick:e,children:i("creator.actions.cancel")})]})]})}function To({clusters:t}){const{t:e}=W(),s=U(),[i,o]=m.useState(0),n=m.useRef(null),[r,l]=m.useState(!1),[c,d]=m.useState(0),[g,u]=m.useState(!1),p=m.useCallback(()=>{l(!1),t[i].forEach(h=>{s.removeContent(h)})},[s,t,i]),f=m.useCallback(h=>{t[i].forEach(x=>{s.addLabel(x,h)})},[t,i,s]);return a.jsxs(J,{title:e("creator.titles.clusterViewer"),dataWidget:"clusterinstance",style:{width:"400px"},noPadding:!0,menu:a.jsxs("div",{children:[a.jsx(nt,{ref:n,onClick:()=>l(!0),children:a.jsx($t,{})}),a.jsxs(Et,{anchorEl:n.current,open:r,onClose:()=>l(!1),children:[a.jsx(Y,{disabled:c===2,onClick:()=>{u(!0),l(!1)},children:e("creator.actions.addTagToCluster")}),a.jsx(Y,{disabled:c===2,onClick:p,children:e("creator.actions.deleteCluster")})]})]}),children:[a.jsx(Ms,{open:g,onClose:()=>u(!1),onAdd:f}),a.jsxs(ue,{value:c,onChange:(h,x)=>d(x),children:[a.jsx(dt,{label:e("creator.labels.clusterImages")}),a.jsx(dt,{label:e("creator.labels.clusterStats")}),a.jsx(dt,{label:e("creator.labels.clusterSummary")})]}),c===0&&a.jsxs("div",{className:$.clusterGroup,children:[a.jsx(os,{count:t.length,page:i+1,onChange:(h,x)=>o(x-1)}),a.jsx("div",{style:{height:"300px",overflow:"auto"},children:i<t.length&&a.jsx(Lt,{images:t[i],columns:5})})]}),c===1&&a.jsx(wo,{clusters:t,page:i,onPage:o}),c===2&&a.jsx("div",{className:$.clusterGroup,children:a.jsx(So,{clusters:t})})]})}function Eo(){const{t}=W(),[e,s]=m.useState(!1),[i,o]=m.useState([]),[n,r]=m.useState(2),[l,c]=m.useState(6),[d,g]=m.useState(200),u=U(),p=ie(Ot);return m.useEffect(()=>{if(e){const f=u.graph.getNodesByType("content"),h=f.map(y=>{const v=u.getContentMetadata(y);return{id:y,embedding:(v==null?void 0:v.embedding)||[]}}),x=zs(h,{maxDistance:n,k:l,minClusterSize:d});x.forEach((y,v)=>{y.forEach(b=>{const _=f[b],C=u.getContentMetadata(_);C&&(C.cluster=v)})}),o(x.map(y=>y.map(v=>f[v]))),s(!1)}},[e,n,l,d,u]),a.jsx(a.Fragment,{children:a.jsxs("div",{className:$.widgetColumn,"data-widget":"container",children:[a.jsxs(J,{title:t("creator.titles.cluster"),dataWidget:"cluster",style:{maxWidth:"300px"},children:[p&&a.jsxs("div",{className:$.group,children:[a.jsx("label",{id:"autoencoder-memberdist-slider",children:t("creator.labels.maxMemberDist")}),a.jsx(st,{"aria-labelledby":"autoencoder-memberdist-slider",value:n,onChange:(f,h)=>{r(h)},min:0,max:2,step:.01,valueLabelDisplay:"auto"}),a.jsx("label",{id:"autoencoder-mincluster-slider",children:t("creator.labels.minClusters")}),a.jsx(st,{"aria-labelledby":"autoencoder-mincluster-slider",value:l,onChange:(f,h)=>{c(h)},min:2,max:100,step:1,valueLabelDisplay:"auto"}),a.jsx("label",{id:"autoencoder-minsize-slider",children:t("creator.labels.minClusterSize")}),a.jsx(st,{"aria-labelledby":"autoencoder-minsize-slider",value:d,onChange:(f,h)=>{g(h)},min:1,max:200,step:1,valueLabelDisplay:"auto"})]}),a.jsx("div",{className:$.group,children:a.jsx(lt,{variant:"contained",onClick:()=>s(!0),children:t("creator.actions.cluster")})})]}),a.jsx(To,{clusters:i})]})})}function Le(t,e){let s=0,i=0;e.forEach(r=>{const l=t.getContentMetadata(r);l&&(l.embedding&&(s=Math.max(s,l.embedding.length)),l.cluster!==void 0&&(i=Math.max(i,l.cluster+1)))});const o=new Map;return{features:e.map(r=>{const l=t.getContentMetadata(r);if(l){const c=(l==null?void 0:l.cluster)||i+1;o.set(r,c);const d=l.embedding||new Array(s).fill(0),g=new Array(i).fill(0).map((u,p)=>c===p?1:0);return[...d,...g]}return[...new Array(s).fill(0),...new Array(i).fill(0)]}),clusters:o,numberOfClusters:i}}function $o(){const{t}=W(),[e,s]=m.useState(!1),[i,o]=m.useState(30),[n]=m.useState(2),[r,l]=m.useState(.001),[c,d]=m.useState(),[g,u]=m.useState(!1),[p,f]=m.useState([]),h=U(),[x,y]=m.useState([]),v=ie(Ot);return m.useEffect(()=>{const _=h.graph.getNodesByType("content").map(C=>{const k=h.getContentMetadata(C),S=k==null?void 0:k.point;return{x:(S==null?void 0:S[0])||0,y:(S==null?void 0:S[1])||0,d:0,id:C,cluster:(k==null?void 0:k.cluster)||0,colour:"black"}});f(_)},[h]),m.useEffect(()=>{if(g&&c){const b=h.graph.getNodesByType("content"),{features:_,clusters:C,numberOfClusters:k}=Le(h,b),M=c.generate(_).map((A,I)=>({x:A[0],y:A[1],d:0,id:b[I],cluster:C.get(b[I])||0,colour:_n((C.get(b[I])||0)/k*360,100,50)})),T=M.reduce((A,I)=>A+I.x,0)/M.length,w=M.reduce((A,I)=>A+I.y,0)/M.length,P=M.reduce((A,I)=>Math.min(A,I.x),100),E=M.reduce((A,I)=>Math.min(A,I.y),100),R=M.reduce((A,I)=>Math.max(A,I.x),-100),N=M.reduce((A,I)=>Math.max(A,I.y),-100);M.forEach(A=>{A.d=Math.abs(A.x-T+(A.y-w)),A.x=Math.max(0,Math.min(1,(A.x-P)/(R-P))),A.y=Math.max(0,Math.min(1,(A.y-E)/(N-E)))}),M.sort((A,I)=>A.d-I.d),M.forEach(A=>{const I=h.getContentMetadata(A.id);I&&(I.point=[A.x,A.y])}),u(!1),f(M)}},[g,c,h]),m.useEffect(()=>{if(e){const{features:b}=Le(h,h.graph.getNodesByType("content")),_=new Bs,C=b[0].length||20;_.create(n,C,{noRegularization:!0,outputActivation:"linear",learningRate:r,loss:"cosineProximity",layers:[16]}),d(k=>{if(k)try{k.dispose()}catch(S){console.error(S)}return _}),y([]),_.train(b,i,(k,S)=>{S&&y(M=>[...M,{epoch:k+1,loss:S.loss,validationLoss:S.val_loss}])}).then(()=>{s(!1),u(!0)})}},[e,i,h,n,r]),a.jsxs("div",{className:$.widgetColumn,"data-widget":"container",children:[a.jsx(J,{title:t("creator.titles.points"),dataWidget:"points",style:{maxWidth:"360px"},children:a.jsx("svg",{width:300,height:300,viewBox:"0 0 300 300",className:$.pointSvg,children:p.map((b,_)=>b.x>=0&&a.jsx("circle",{r:"2",fill:b.colour,cx:b.x*300,cy:b.y*300},_))})}),a.jsxs(J,{title:t("creator.titles.mapping"),dataWidget:"mapping",style:{width:"300px"},children:[v&&a.jsxs("div",{className:$.group,children:[a.jsx("label",{id:"autoencoder-epoch-slider",children:t("creator.labels.epochs")}),a.jsx(st,{disabled:e,"aria-labelledby":"autoencoder-epoch-slider",value:i,onChange:(b,_)=>{o(_)},min:10,max:200,step:10,valueLabelDisplay:"auto"}),a.jsx("label",{id:"autoencoder-rate-slider",children:t("creator.labels.learningRate")}),a.jsx(st,{disabled:e,"aria-labelledby":"autoencoder-rate-slider",value:r,onChange:(b,_)=>{l(_)},min:1e-4,max:.002,step:1e-4,valueLabelDisplay:"auto"})]}),a.jsx("div",{className:$.group,children:a.jsx(as,{variant:"contained",busy:e,onClick:()=>s(!0),children:t("creator.actions.train")})})]}),v&&a.jsx(J,{title:t("creator.titles.mapTraining"),dataWidget:"points",style:{width:"300px"},children:a.jsx("div",{className:$.group,children:a.jsx(Is,{data:x,maxEpochs:i})})})]})}function Lo({images:t,onDeleted:e}){const{t:s}=W(),i=m.useRef(null),[o,n]=m.useState(!1),[r,l]=m.useState(!1),c=U(),d=mt(()=>{const u=new Map;return t&&t.forEach(p=>{const f=c.getContentMetadata(p);f&&f.labels.forEach(h=>{u.set(h.label,(u.get(h.label)||0)+1)})}),Array.from(u)},[c,t],"contentmeta"),g=(t==null?void 0:t.length)||0;return a.jsxs(J,{title:s("creator.titles.imageDetail"),dataWidget:"image",style:{maxWidth:"400px"},menu:a.jsxs("div",{children:[a.jsx(nt,{ref:i,onClick:()=>n(!0),children:a.jsx($t,{})}),a.jsxs(Et,{anchorEl:i.current,open:o,onClose:()=>n(!1),children:[a.jsx(Y,{onClick:()=>{t&&t.length>0&&t.forEach(u=>{c.clearLabels(u)}),n(!1)},children:s("creator.actions.deleteTags")}),a.jsx(Y,{onClick:()=>{t&&t.length>0&&(t.forEach(u=>{c.removeContent(u)}),e()),n(!1)},children:s("creator.actions.deleteImage")})]})]}),children:[a.jsx(Ms,{open:r,onClose:()=>l(!1),onAdd:u=>{t&&t.forEach(p=>{c.addLabel(p,u,1)})}}),a.jsx("div",{className:$.imageContainer,children:a.jsx(Lt,{images:t||[],columns:g===1?1:g<5?2:3})}),a.jsxs("div",{className:$.imageTags,children:[d.map((u,p)=>a.jsx(ke,{color:u[1]===g?"success":"warning",variant:"outlined",label:`#${u[0]}`,onDelete:()=>{t&&t.forEach(f=>c.removeLabel(f,u[0]))}},p)),t&&a.jsx(ke,{variant:"filled",color:"primary",label:s("creator.actions.add"),icon:a.jsx(ze,{}),onClick:()=>l(!0)})]})]})}function Ro({value:t,onChange:e}){const{t:s}=W(),i=U(),o=mt(()=>i.getAllLabels(),[i],"contentmeta");return a.jsx(pe,{selectOnFocus:!0,sx:{width:"200px"},value:t,onChange:(n,r)=>{e(r)},renderInput:n=>a.jsx(Tt,{...n,label:s("creator.labels.selectTag"),size:"small",InputProps:{...n.InputProps,startAdornment:a.jsx(de,{position:"start",children:a.jsx(Fe,{fontSize:"small"})})}}),options:o})}function No({value:t,onChange:e}){const{t:s}=W(),i=U(),o=mt(()=>{let n=0;i.getAllContent().forEach(c=>{const d=i.getContentMetadata(c);d&&d.cluster!==void 0&&(n=Math.max(n,d.cluster))});const l=[];for(let c=0;c<=n;++c)l.push(`Cluster-${c}`);return l},[i],"contentmeta");return a.jsx(pe,{selectOnFocus:!0,sx:{width:"200px"},value:t,onChange:(n,r)=>{e(r)},renderInput:n=>a.jsx(Tt,{...n,label:s("creator.labels.selectCluster"),size:"small"}),options:o})}function Do(){const{t}=W(),[e,s]=m.useState([]),i=U(),[o,n]=m.useState([]),r=vn(),l=m.useRef(null),[c,d]=m.useState(!1),[g,u]=m.useState("none"),[p,f]=m.useState(null),[h,x]=m.useState(null);m.useEffect(()=>{g==="none"?s(r):g==="tag"?s(p===null?r:r.filter(v=>{const b=i.getContentMetadata(v);return b&&b.labels.map(_=>_.label).includes(p)})):g==="notag"?s(r.filter(v=>{const b=i.getContentMetadata(v);return b&&b.labels.length===0})):g==="cluster"&&s(r.filter(v=>{const b=i.getContentMetadata(v);return b&&`Cluster-${b.cluster}`===h}))},[i,r,g,p,h]);const y=m.useCallback(v=>{u(v.target.value)},[]);return a.jsxs("div",{className:$.widgetColumn,"data-widget":"container",children:[a.jsxs(J,{title:t("creator.titles.browser"),dataWidget:"browser",style:{width:"500px"},noPadding:!0,menu:a.jsxs("div",{children:[a.jsx(nt,{ref:l,onClick:()=>d(!0),children:a.jsx($t,{})}),a.jsx(Et,{anchorEl:l.current,open:c,onClose:()=>d(!1),children:a.jsx(Y,{onClick:()=>{n([]),d(!1)},children:t("creator.actions.unselectAll")})})]}),children:[a.jsxs("div",{className:$.controls,children:[a.jsxs(qs,{children:[a.jsx(Qs,{id:"browser-filter-select",children:t("creator.labels.filter")}),a.jsxs(Js,{labelId:"browser-filter-select",value:g,label:t("creator.labels.filter"),onChange:y,size:"small",children:[a.jsx(Y,{value:"none",children:t("creator.labels.noFilter")}),a.jsx(Y,{value:"tag",children:t("creator.labels.byTag")}),a.jsx(Y,{value:"cluster",children:t("creator.labels.byCluster")}),a.jsx(Y,{value:"notag",children:t("creator.labels.noTags")})]})]}),g==="tag"&&a.jsx(Ro,{value:p,onChange:f}),g==="cluster"&&a.jsx(No,{value:h,onChange:x})]}),a.jsx("div",{style:{width:"100%",height:"500px",overflowY:"scroll"},children:a.jsx(Lt,{images:e,columns:4,selected:o,onSelect:v=>n(b=>b.includes(v)?b.filter(_=>_!==v):[...b,v])})})]}),a.jsx(Lo,{images:o.length>0?o:void 0,onDeleted:()=>{n([]),s(i.getAllContent())}})]})}function zo({open:t,onClose:e}){const{t:s}=W(),[i,o]=Fs(Ot);return a.jsxs(re,{open:t,onClose:e,scroll:"paper",maxWidth:"xs",fullWidth:!0,children:[a.jsx(ce,{children:s("creator.titles.settings")}),a.jsx(nt,{"aria-label":"close",onClick:e,sx:{position:"absolute",right:8,top:8,color:n=>n.palette.grey[500]},children:a.jsx(Pn,{})}),a.jsx(le,{children:a.jsx("div",{className:$.column,children:a.jsx(xt,{control:a.jsx(St,{checked:i,onChange:(n,r)=>o(r)}),label:s("creator.labels.advanced")})})})]})}const Bo=[{start:"query",end:"summary",startPoint:"right",endPoint:"left"},{start:"summary",end:"embed",startPoint:"right",endPoint:"left"},{start:"embed",end:"cluster",startPoint:"right",endPoint:"left"},{start:"cluster",end:"mapping",startPoint:"right",endPoint:"left"},{start:"embed",end:"similarity",startPoint:"bottom",endPoint:"top"},{start:"mapping",end:"points",startPoint:"bottom",endPoint:"top"},{start:"cluster",end:"clusterinstance",startPoint:"bottom",endPoint:"top"},{start:"mapping",end:"browser",startPoint:"right",endPoint:"left"},{start:"browser",end:"image",startPoint:"bottom",endPoint:"top"}];function Fo(){const{t}=W(["tools"]),{content:e,profiler:s,actionLog:i}=Hs(),[o,n]=m.useState([]),r=m.useRef(null),l=m.useRef(),c=jn(),d=Os(kn),[g,u]=m.useState(!1);m.useEffect(()=>{if(r.current){l.current=new ResizeObserver(()=>{if(r.current){const h=Ws(r.current);n(Us(h,Bo))}}),l.current.observe(r.current);const f=r.current.children;if(f)for(let h=0;h<f.length;++h){const x=f[h];l.current.observe(x)}return()=>{var h;(h=l.current)==null||h.disconnect()}}},[]);const p=m.useCallback(async()=>{let f=!0;const h=e.getAllContent();if(h.forEach(y=>{const v=e.getContentMetadata(y);v?(v.embedding||d(b=>{const _=new Set(b);return _.add("missing_embeddings"),f=!1,_}),v.cluster===void 0&&d(b=>{const _=new Set(b);return _.add("missing_cluster"),f=!1,_}),v.point||d(b=>{const _=new Set(b);return _.add("missing_points"),f=!1,_})):d(b=>{const _=new Set(b);return _.add("content_not_found"),f=!1,_})}),!f)return;const x=h.map(async y=>{const v=e.getContentMetadata(y),b=e.getContentData(y),_=e.getContentData(y,!0);if(b&&v&&(!_||_.length===b.length)){const k=(await oe(b,100)).toDataURL("image/jpeg",.95);e.addContentData({normal:b,lowRes:k},v)}});await Promise.all(x),tn(s,e,i,{includeContent:!0,includeProfiles:!1,includeLogs:!1,includeGraph:!1,settings:await c()})},[i,e,s,c,d]);return a.jsxs(Sn,{i18n:Gs,defaultNS:"tools",children:[a.jsx("div",{className:$.workspace,children:a.jsxs("div",{className:$.container,ref:r,children:[a.jsx(Ks,{lines:o}),a.jsx(ho,{disabled:!1}),a.jsx(yo,{onFindMore:()=>{}}),a.jsx(Po,{}),a.jsx(Eo,{}),a.jsx($o,{}),a.jsx(Do,{})]})}),a.jsxs(yn,{placement:"top",label:a.jsx("div",{className:$.menuLogo,children:t("creator.titles.creator")}),children:[a.jsx(Qt,{tooltip:t("creator.tooltips.download"),children:a.jsx(nt,{color:"inherit",onClick:p,children:a.jsx(Cn,{})})}),a.jsx(Qt,{tooltip:t("creator.tooltips.deleteAll"),children:a.jsx(nt,{color:"inherit",onClick:()=>e.reset(),children:a.jsx(_o,{})})}),a.jsx(Qt,{tooltip:t("creator.labels.showSettings"),children:a.jsx(nt,{color:"inherit",onClick:()=>u(!0),"aria-label":t("creator.labels.showSettings"),children:a.jsx(An,{})})})]}),a.jsx(zo,{open:g,onClose:()=>u(!1)})]})}function Kr(){return a.jsx(Fo,{})}export{Kr as Component};
