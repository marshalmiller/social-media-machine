import{a1 as h,a7 as v,r as i,c as j,v as I,R as P,j as e}from"./index-02b2945e.js";import{s as d,D as w}from"./DataProfilePure-287e5c3b.js";import{u as D}from"./profiler-25e786d5.js";import{F as L}from"./FileSaver.min-7671c644.js";import{P as R}from"./PrintButton-dcdd5a18.js";import{I as g}from"./Item-79c80338.js";import{I as b}from"./IconMenuInline-1e64afd8.js";import{a as C}from"./configState-6be3aa1d.js";import{s as M}from"./svgToPNG-975d57d1.js";import{D as A}from"./Download-633f4aec.js";import{I as E}from"./IconButton-02bc1303.js";function S(c){const a=h(),l=v(),o=c,[s,r]=i.useReducer(t=>++t,0);return i.useEffect(()=>{const t=()=>r();return a.on(`log-${o}`,t),()=>a.off(`log-${o}`,t)},[o,a]),i.useMemo(()=>l.getActionLog(o).filter(t=>!!t.id).reverse(),[s,o])}function z({id:c,disableMenu:a,noImageCloud:l}){const{t:o}=j(),s=D(c),r=I(),t=S(c||r.getCurrentUser()),m=P(C),f=i.useRef(null),u=i.useMemo(()=>s.affinities.contents.contents.map(n=>({weight:n.weight,image:r.content.getContentData(n.id)||""})),[s,r]),p=i.useMemo(()=>t.map(n=>({entry:n,content:n.id&&r.content.getContentData(n.id)||""})),[t,r]),x=()=>{f.current&&M(f.current,4).then(n=>{L.saveAs(n,`imagecloud_${s.name}.png`)})};return e.jsx("div",{className:d.outerContainer,children:e.jsxs("div",{className:d.container,tabIndex:0,children:[!(m!=null&&m.disablePrinting)&&!a&&e.jsxs(b,{children:[e.jsx(g,{tooltip:o("profile.actions.print"),children:e.jsx(R,{ariaLabel:o("profile.actions.print"),data:()=>({title:s.name,weightedImages:u,actionLog:p}),path:"data"})}),e.jsx(g,{tooltip:o("profile.actions.download"),children:e.jsx(E,{onClick:x,color:"inherit","aria-label":o("profile.actions.download"),children:e.jsx(A,{})})})]}),e.jsx(w,{ref:f,content:l?void 0:u,log:p})]})})}export{z as P};
