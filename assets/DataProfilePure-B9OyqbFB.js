import{c as d,j as s,r as m,a8 as f,I as v}from"./index-ChHXuf40.js";import{t as x,C as y,a as p,I as _}from"./ImageCloud-DbSTI7VI.js";const j="_container_iathn_3",w="_outerContainer_iathn_14",C="_svgContainer_iathn_25",I={container:j,outerContainer:w,svgContainer:C};function g(e,t){switch(e.activity){case"engagement":return t("feed.actionlog.engagement",{score:Math.min(10,Math.max(0,(e.value||0)*10)).toFixed()});case"inactive":return t("feed.actionlog.inactive",{time:((e.value||0)/1e3).toFixed(1)});case"dwell":return t("feed.actionlog.dwell",{time:((e.value||0)/1e3).toFixed(1)});case"comment":return t("feed.actionlog.comment",{length:e.value||0});default:return t(`feed.actionlog.${e.activity}`)}}const L="_logItem_17ywp_3",$="_time_17ywp_19",b="_buttonListItem_17ywp_25",u={logItem:L,time:$,buttonListItem:b};function E({item:e}){const{t}=d();return s.jsxs("div",{className:u.logItem,"data-testid":"log-item",children:[s.jsx("div",{children:g(e,t)}),s.jsx("div",{className:u.time,children:x(e.timestamp)})]})}const F=m.memo(function({batch:t}){const{t:i}=d();if(t.length===0)return null;const c=g(t[0].entry,i),r=t[0].content;return s.jsx(y,{message:c,image:r,score:t[0].entry.value||0,children:t.slice(1).map((a,o)=>s.jsx(E,{item:a.entry},o))})});function N(e,t){const i=[[]];if(e.length===0)return i;let c=!1;for(let r=0;r<e.length;++r){const a=e[r],o=i[i.length-1];if(o.length>0&&o[0].entry.id!==a.entry.id){if(c){i.push(...t.slice(1));break}i.push([a])}else o.push(a);const n=t[0],l=(n==null?void 0:n.length)-1;n&&n.length>0&&a.entry.id===n[l].entry.id&&a.entry.timestamp===n[l].entry.timestamp&&(c=!0)}if(e[0].entry.activity!=="engagement"){const r=f(i[0].map(a=>a.entry));i[0].unshift({entry:{activity:"engagement",timestamp:e[0].entry.timestamp,value:r,id:e[0].entry.id},content:e[0].content})}return i}function P({log:e,fixedSize:t}){const{t:i}=d(),[c,r]=m.useState(t||5),[a,o]=m.useState([]);return m.useEffect(()=>{r(t||5)},[t]),m.useEffect(()=>{o(n=>N(e,n))},[e]),s.jsxs(p,{children:[a.slice(0,c).map((n,l)=>s.jsx(F,{batch:n},l)),!t&&s.jsx("li",{className:u.buttonListItem,children:s.jsx(v,{variant:"outlined",onClick:()=>{r(n=>n+5)},sx:{margin:"1rem 0.5rem"},children:i("profile.actions.more")})})]})}const M=m.forwardRef(function({cloudSize:t=300,log:i,content:c,fixedSize:r},a){const[o,n]=m.useState(t),l=m.useCallback(h=>{n(h)},[]);return s.jsxs(s.Fragment,{children:[c&&s.jsx("div",{className:I.svgContainer,children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:`${t}px`,viewBox:`${-(o*1.67)} ${-o} ${o*1.67*2} ${o*2}`,ref:a,children:s.jsx(_,{content:c,size:t,onSize:l})})}),s.jsx(P,{log:i,fixedSize:r})]})});export{M as D,I as s};
