import{r as l,c as b,j as e}from"./index-ChHXuf40.js";import{c as S,C as v,I as B,a as L}from"./ImageCloud-DbSTI7VI.js";import{l as R}from"./localiser-C36yOspj.js";import{g as N}from"./graphColours-CmwBa87t.js";import{P as W}from"./ScorePie-BXvYOECH.js";const E="_word_hbzn6_3",y="_container_hbzn6_16",T="_outerContainer_hbzn6_27",U="_topicContainer_hbzn6_51",k="_svgContainer_hbzn6_65",_={word:E,container:y,outerContainer:T,topicContainer:U,svgContainer:k},q="_cloudItem_1uz9t_3",A={cloudItem:q},z=15,D=l.memo(function({content:t,size:a,padding:r,onSize:n,className:h}){const{i18n:i}=b(),m=l.useRef(null),[d,u]=l.useState(new Map);l.useEffect(()=>{const o=t.map((g,M)=>{var $;const j=($=m.current)==null?void 0:$.children[M],C=j==null?void 0:j.querySelector("text"),x=C&&C.getBBox?C.getBBox():{width:50,height:20};return!x||x.width<=5||x.height<=5?{id:g.label,width:0,height:0}:{id:g.label,width:x.width+20,height:x.height}}),[s,I]=S(o.filter(g=>g.width>5&&g.height>5),a||500,r);n&&n(Math.floor(I));const P=new Map;s.forEach(g=>P.set(g.item.id,g)),u(P)},[t,r,a,n]);const w=l.useMemo(()=>t.length>0?t[0].weight:1,[t]),p=l.useMemo(()=>t.length>1?t[t.length-1].weight:0,[t]);return e.jsx("g",{"data-testid":"wordcloud-group",ref:m,children:t.map(o=>{const s=d.get(o.label);return o.weight===0?null:e.jsxs("g",{className:h||A.cloudItem,transform:s?`translate(${s.x}, ${s.y})`:"translate(0,0)",children:[s&&e.jsx("rect",{x:0,y:0,rx:"6px",width:s.item.width,height:s.item.height,fill:"#444"}),e.jsx("text",{dominantBaseline:"middle",textAnchor:"middle",fontSize:Math.floor((o.weight-p)/(w-p)*.1*((a||500)-z))+z,"data-testid":"cloud-image",x:((s==null?void 0:s.item.width)||0)/2,y:((s==null?void 0:s.item.height)||0)/2,visibility:s?"visible":"hidden",fill:"white",children:R.getLocalisedLabel(o.label,i.language)})]},o.label)})})});function F({data:c,size:t=200}){const{i18n:a}=b(),[r,n]=l.useState(t),h=l.useCallback(i=>{n(i)},[]);return e.jsx(v,{message:`#${R.getLocalisedLabel(c.topic,a.language)}`,score:c.score,image:c.image,children:e.jsx("div",{className:_.topicContainer,"data-testid":`topic-detail-${c.topic}`,children:e.jsx("svg",{width:"100%",height:`${t}px`,viewBox:`${-(r*1.67)} ${-r} ${r*1.67*2} ${r*2}`,children:e.jsx(B,{content:c.images.slice(0,10),size:t,onSize:h})})})})}const Z="_chart_1gq43_16",G={chart:Z};function f({summary:c,title:t,percent:a}){const r=c.slice(0,5).map((n,h)=>({id:h,label:n.label,value:n.percent}));return r.sort((n,h)=>h.value-n.value),c.length>0?e.jsx(v,{title:t,score:a,children:e.jsx("div",{className:G.chart,children:e.jsx(W,{series:[{outerRadius:70,paddingAngle:5,cornerRadius:4,innerRadius:5,cx:70,cy:90,data:r}],colors:N,width:340,height:190})})}):null}const V=l.forwardRef(function({wordCloudSize:t=300,imageCloudSize:a=200,engagement:r,topics:n,wordCloud:h,summary:i},m){const{t:d}=b(),[u,w]=l.useState(t),p=l.useCallback(o=>{w(o)},[]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:_.svgContainer,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:`${t}px`,ref:m,viewBox:`${-(u*1.67)} ${-u} ${u*1.67*2} ${u*2}`,children:e.jsx(D,{content:h,size:t,className:_.word,onSize:p})})}),i&&e.jsxs(L,{children:[e.jsx(v,{title:d("profile.titles.engagement"),score:r}),n.map(o=>e.jsx(F,{data:o,size:a},o.topic)),e.jsx(f,{title:d("profile.titles.sharingPreference"),summary:i.shared,percent:i.sharedPercent}),e.jsx(f,{title:d("profile.titles.followPreference"),summary:i.followed,percent:i.followedPercent}),e.jsx(f,{title:d("profile.titles.commentPreference"),summary:i.commented,percent:i.commentedPercent}),e.jsx(f,{title:d("profile.titles.reactPreference"),summary:i.reacted,percent:i.reactedPercent}),e.jsx(f,{title:d("profile.titles.viewPreference"),summary:i.viewed,percent:i.viewedPercent})]})]})});export{V as U,D as W,_ as s};
