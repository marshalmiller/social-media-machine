import{r as c,c as j,j as e}from"./index-02b2945e.js";import{c as B,C as $,I as N,a as R}from"./ImageCloud-fcac825d.js";import{l as z}from"./localiser-c0c9a31b.js";import{g as I}from"./graphColours-c6ae9e73.js";import{P as M}from"./ScorePie-ef00e97d.js";const y="#dfe5e8",L="#078092",U="#5f7377",W="#444",E="_word_hbzn6_3",T="_container_hbzn6_16",q="_outerContainer_hbzn6_27",A="_similarUser_hbzn6_38",F="_userName_hbzn6_47",Z="_topicContainer_hbzn6_51",G="_svgContainer_hbzn6_65",C={workspaceBg:y,bgColourful1:L,backgroundDark:U,textDark:W,word:E,container:T,outerContainer:q,similarUser:A,userName:F,topicContainer:Z,svgContainer:G},H="#078092",J="#444",K="_cloudItem_1uz9t_3",O={bgColourful1:H,textDark:J,cloudItem:K},k=15,Q=c.memo(function({content:t,size:l,padding:o,onSize:s,className:d}){const{i18n:r}=j(),m=c.useRef(null),[h,g]=c.useState(new Map);c.useEffect(()=>{const n=t.map((u,S)=>{var P;const b=(P=m.current)==null?void 0:P.children[S],_=b==null?void 0:b.querySelector("text"),x=_&&_.getBBox?_.getBBox():{x:0,y:0,width:50,height:20};return!x||x.width<=5||x.height<=5?{id:u.label,width:0,height:0}:{id:u.label,width:x.width+20,height:x.height}}),[i,D]=B(n.filter(u=>u.width>5&&u.height>5),l||500,o);s&&s(Math.floor(D));const v=new Map;i.forEach(u=>v.set(u.item.id,u)),g(v)},[t,o,l,s]);const w=c.useMemo(()=>t.length>0?t[0].weight:1,[t]),p=c.useMemo(()=>t.length>1?t[t.length-1].weight:0,[t]);return e.jsx("g",{"data-testid":"wordcloud-group",ref:m,children:t.map(n=>{const i=h.get(n.label);return n.weight===0?null:e.jsxs("g",{className:d||O.cloudItem,transform:i?`translate(${i.x}, ${i.y})`:"translate(0,0)",children:[i&&e.jsx("rect",{x:0,y:0,rx:"6px",width:i.item.width,height:i.item.height,fill:"#444"}),e.jsx("text",{dominantBaseline:"middle",textAnchor:"middle",fontSize:Math.floor((n.weight-p)/(w-p)*.1*((l||500)-k))+k,"data-testid":"cloud-image",x:((i==null?void 0:i.item.width)||0)/2,y:((i==null?void 0:i.item.height)||0)/2,visibility:i?"visible":"hidden",fill:"white",children:z.getLocalisedLabel(n.label,r.language)})]},n.label)})})});function V({data:a,size:t=200}){const{i18n:l}=j(),[o,s]=c.useState(t),d=c.useCallback(r=>{s(r)},[]);return e.jsx($,{message:`#${z.getLocalisedLabel(a.topic,l.language)}`,score:a.score,image:a.image,children:e.jsx("div",{className:C.topicContainer,"data-testid":`topic-detail-${a.topic}`,children:e.jsx("svg",{width:"100%",height:`${t}px`,viewBox:`${-(o*1.67)} ${-o} ${o*1.67*2} ${o*2}`,children:e.jsx(N,{content:a.images.slice(0,10),size:t,onSize:d})})})})}const X="#008297",Y="#444",ee="#078092",te="#e8f0fe",re="_container_1gq43_3",ie="_chart_1gq43_16",oe={primary:X,textDark:Y,bgColourful1:ee,bgSubdued1:te,container:re,chart:ie};function f({summary:a,title:t,percent:l}){const o=a.slice(0,5).map((s,d)=>({id:d,label:s.label,value:s.percent}));return o.sort((s,d)=>d.value-s.value),a.length>0?e.jsx($,{title:t,score:l,children:e.jsx("div",{className:oe.chart,children:e.jsx(M,{series:[{outerRadius:70,paddingAngle:5,cornerRadius:4,innerRadius:5,cx:70,cy:90,data:o}],colors:I,width:340,height:190})})}):null}const de=c.forwardRef(function({wordCloudSize:t=300,imageCloudSize:l=200,engagement:o,topics:s,wordCloud:d,summary:r},m){const{t:h}=j(),[g,w]=c.useState(t),p=c.useCallback(n=>{w(n)},[]);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:C.svgContainer,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:`${t}px`,ref:m,viewBox:`${-(g*1.67)} ${-g} ${g*1.67*2} ${g*2}`,children:e.jsx(Q,{content:d,size:t,className:C.word,onSize:p})})}),r&&e.jsxs(R,{children:[e.jsx($,{title:h("profile.titles.engagement"),score:o}),s.map(n=>e.jsx(V,{data:n,size:l},n.topic)),e.jsx(f,{title:h("profile.titles.sharingPreference"),summary:r.shared,percent:r.sharedPercent}),e.jsx(f,{title:h("profile.titles.followPreference"),summary:r.followed,percent:r.followedPercent}),e.jsx(f,{title:h("profile.titles.commentPreference"),summary:r.commented,percent:r.commentedPercent}),e.jsx(f,{title:h("profile.titles.reactPreference"),summary:r.reacted,percent:r.reactedPercent}),e.jsx(f,{title:h("profile.titles.viewPreference"),summary:r.viewed,percent:r.viewedPercent})]})]})});export{de as U,Q as W,C as s};
