import{l as c,j as r,r as h}from"./index-ChHXuf40.js";import{s as n,T as f}from"./TableToolbar-iL5UqPm0.js";import{D as g}from"./DataGrid-CeymwZOP.js";import{a as w}from"./events-DLU3_18Y.js";import"./createSimplePaletteValueFilter-CLdyqM5U.js";import"./EventManager-bMdfXZ0t.js";import"./TextField-MaMPnnBO.js";import"./useSlot-BVU38s2u.js";import"./IconButton-BXLcq7Mr.js";import"./Portal-BpkAKKpt.js";import"./useFormControl-BOywDUuq.js";import"./Popover-3SaqCWbK.js";import"./Grow-B-eHZ5Kq.js";import"./debounce-Be36O1Ab.js";import"./Modal-DQ9h7Q_m.js";import"./index-BfNLg11A.js";import"./useSlotProps-BP5ya9qr.js";import"./MenuItem-C3-73DVz.js";import"./Typography-8VlALfQ4.js";import"./Close-CI_IAYQS.js";import"./Popper-JH9MxI6g.js";import"./Chip-BlC7IdM3.js";import"./Tooltip-cL7nY1NY.js";import"./InputAdornment-CUBj53no.js";import"./Button-CbhWiO3H.js";import"./FormControlLabel-BtHiVqzu.js";import"./SwitchBase-CuDlXbI3.js";import"./LinearProgress-li3lTmA_.js";import"./useThemeProps-Rdar5cgY.js";const u=[{field:"image",headerName:"Picture",width:80,renderCell:i=>i.value?r.jsx("img",{src:i.value,width:48,height:48}):null},{field:"name",headerName:"User",width:200},{field:"userId",headerName:"ID",width:200},{field:"engagement",headerName:"Engagement",width:80,renderCell:i=>i.value.toFixed(1)},{field:"topic",headerName:"Main Topic",width:150},{field:"follows",headerName:"Followers",width:80},{field:"followed",headerName:"Followed",width:80},{field:"liked",headerName:"Liked",width:80},{field:"viewedImages",headerName:"Viewed",width:80},{field:"comments",headerName:"Comments",width:80},{field:"shares",headerName:"Shares",width:80},{field:"dwellTime",headerName:"View Time",width:80,renderCell:i=>`${(i.value/1e3).toFixed(1)}s`}];function v(){const{profiler:i,actionLog:m}=c(),s=i.graph.getNodesByType("user").map(l=>{var a;const e=i.getUserData(l),o=m.getActionLog(l);return{id:l,userId:l,image:e!=null&&e.image?i.content.getContentData(e.image):void 0,name:(e==null?void 0:e.name)||"No name",follows:(e==null?void 0:e.followerCount)||0,followed:(e==null?void 0:e.followsCount)||0,engagement:(e==null?void 0:e.engagement)||0,dwellTime:o.filter(t=>t.activity==="dwell").reduce((t,p)=>t+(p.value||0),0),topic:((a=e==null?void 0:e.affinities.topics.topics[0])==null?void 0:a.label)||"None",viewedImages:o.filter(t=>t.activity==="seen").length,liked:o.filter(t=>t.activity==="like").length,comments:o.filter(t=>t.activity==="comment").length,shares:o.filter(t=>t.activity==="share_public").length}});return r.jsx("div",{className:n.container,children:r.jsx("div",{className:n.tableContainer,"data-testid":"user-table",children:r.jsx(g,{slots:{toolbar:f},rows:s,columns:u,initialState:{columns:{columnVisibilityModel:{userId:!1,follows:!1}},sorting:{sortModel:[{field:"engagement",sort:"desc"}]}}})})})}function Q(){const[i,m]=h.useReducer(d=>++d,0);return w(()=>{m()},[],"refresh_graph"),r.jsx(v,{},`k-${i}`)}export{Q as Component};
