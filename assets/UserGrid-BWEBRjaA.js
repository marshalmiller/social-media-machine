import{c as z,a as N,r as p,R as C,l as D,j as e,g as R,b as M,N as $}from"./index-ChHXuf40.js";import{I as L,T as y,C as F,D as E,a as A,F as B,b as G,P as T,R as W}from"./DeleteDialog-BrGVoYLl.js";import{S as v}from"./Spacer-Mn4BAxg4.js";import{I as q}from"./IconMenu-BwCk8YCn.js";import{I as f}from"./Item-BHRpsj3I.js";import{C as H,P as O}from"./PhoneAndroid-CZhcdyIj.js";import{Q,P as K}from"./Person-BZI0jAoF.js";import{I as J}from"./ImageSearch-B_1ksRDv.js";import{k,n as V}from"./settingsState-D7smp1AL.js";import{o as X,n as S,j as Y,q as Z,r as ee,p as oe}from"./menuState-BrKGn-Zy.js";import{I as x}from"./IconButton-BXLcq7Mr.js";import{u as te}from"./profiler-BgoGrxGa.js";import{b as se}from"./content-CTNkBplU.js";import{I as re}from"./ImageCloud-DbSTI7VI.js";import{W as ae}from"./UserProfilePure-DK7r6jJs.js";import{u as ie,c as ne}from"./UserListing-Da09B9Tx.js";import{c as le}from"./colours.module-BoWwueDy.js";import{a as de}from"./events-DLU3_18Y.js";import"./Popover-3SaqCWbK.js";import"./createSimplePaletteValueFilter-CLdyqM5U.js";import"./useSlot-BVU38s2u.js";import"./Portal-BpkAKKpt.js";import"./Grow-B-eHZ5Kq.js";import"./debounce-Be36O1Ab.js";import"./Modal-DQ9h7Q_m.js";import"./Slider-CstNE_2p.js";import"./useSlotProps-BP5ya9qr.js";import"./Feed-C9lRbnqo.js";import"./CommentBox-7mwBcOn9.js";import"./TextField-MaMPnnBO.js";import"./useFormControl-BOywDUuq.js";import"./index-BfNLg11A.js";import"./localiser-C36yOspj.js";import"./Close-Dh1l5TZE.js";import"./LangSelect-Cnhm6nX0.js";import"./configState-BS87aI9Z.js";import"./recommender-Dk-Nrkxt.js";import"./sessionState-BwviDT66.js";import"./DataProfile-BB0Cy9-2.js";import"./DataProfilePure-B9OyqbFB.js";import"./FileSaver.min-D29rPHm2.js";import"./PrintButton-DlOyJ0WV.js";import"./random-CgHj7PjC.js";import"./IconMenuInline-tbFKdX6Z.js";import"./svgToPNG-Ltd00H6X.js";import"./Download-_Q7eoY82.js";import"./UserProfile-Ba6IyhZ1.js";import"./I18nextProvider-oW3AECIJ.js";import"./RecommendationsProfile-DTCjVtNy.js";import"./ScorePie-BXvYOECH.js";import"./ChartsOverlay-B3YhnLdp.js";import"./useThemeProps-Rdar5cgY.js";import"./Typography-8VlALfQ4.js";import"./Popper-JH9MxI6g.js";import"./string-CFFdVFMV.js";import"./Graph-BKYc9IKD.js";import"./ProgressDialog-CeFbeIBT.js";import"./DialogContent-_GwcI3J5.js";import"./DialogTitle-DRIas77U.js";import"./LinearProgress-li3lTmA_.js";import"./Label-ByPLvDgY.js";import"./graphColours-CmwBa87t.js";import"./RadioGroup-CQMSu_n2.js";import"./SwitchBase-CuDlXbI3.js";import"./ImageGrid-Cx-mYdPF.js";import"./CheckCircle-CXj5CTlc.js";import"./Refresh-CxoqocOo.js";import"./LocalFireDepartment-G8EPqmTC.js";import"./RecommendationsHeatmap-CFho8frj.js";import"./colours-yJq7kSUE.js";import"./DialogActions-DAAXxb6Q.js";import"./Tooltip-cL7nY1NY.js";const ce="_menuLogo_dtzbu_3",me="_grid_dtzbu_14",pe="_gridItem_dtzbu_25",ue="_userImageContainer_dtzbu_55",he="_placeholder_dtzbu_72",ge="_colourBox_dtzbu_85",be="_userNameContainer_dtzbu_90",fe="_selectedUserNameContainer_dtzbu_105 _userNameContainer_dtzbu_90",xe="_word_dtzbu_110",h={menuLogo:ce,grid:me,gridItem:pe,userImageContainer:ue,placeholder:he,colourBox:ge,userNameContainer:be,selectedUserNameContainer:fe,word:xe};function je(){var U,P;const{t:o}=z(),[u,a]=N(k),[c,d]=p.useState(!1),[g,r]=N(X),[t,j]=N(S),l=C(Y),b=C(Z),i=C(ee),s=C(oe),n=p.useRef(),{profiler:m,actionLog:I,similarity:w}=D();return p.useEffect(()=>{t&&t!==n.current&&s!=="none"&&r(s),n.current=t},[t,s,r]),l?e.jsxs(q,{placement:"top",selected:!!t,label:e.jsx("div",{className:h.menuLogo,children:t?(U=m.getUserData(t))==null?void 0:U.name:o("dashboard.titles.people")}),children:[!i&&e.jsxs(e.Fragment,{children:[e.jsx(f,{tooltip:o("dashboard.labels.profileImage"),selected:u==="profileImage",children:e.jsx(x,{color:"inherit",onClick:()=>a("profileImage"),"data-testid":"social-menu-profileImage","aria-label":o("dashboard.labels.profileImage"),children:e.jsx(L,{})})}),e.jsx(f,{tooltip:o("dashboard.labels.engagedImages"),selected:u==="image",children:e.jsx(x,{color:"inherit",onClick:()=>a("image"),"data-testid":"social-menu-images","aria-label":o("dashboard.labels.engagedImages"),children:e.jsx(H,{})})}),e.jsx(f,{tooltip:o("dashboard.labels.topicCloud"),selected:u==="word",children:e.jsx(x,{color:"inherit",onClick:()=>a("word"),"aria-label":o("dashboard.labels.topicCloud"),children:e.jsx(y,{})})}),e.jsx(v,{})]}),e.jsx(F,{}),e.jsx(v,{}),!b&&e.jsxs(e.Fragment,{children:[e.jsx(f,{tooltip:o("dashboard.labels.showFeed"),selected:g==="feed",children:e.jsx(x,{disabled:!t,"data-testid":"social-menu-feed-button",color:"inherit",onClick:()=>r("feed"),"aria-label":o("dashboard.labels.showFeed"),children:e.jsx(O,{})})}),e.jsx(f,{tooltip:o("dashboard.labels.showData"),selected:g==="data",children:e.jsx(x,{disabled:!t,"data-testid":"social-menu-data-button",color:"inherit",onClick:()=>r("data"),"aria-label":o("dashboard.labels.showData"),children:e.jsx(Q,{})})}),e.jsx(f,{tooltip:o("dashboard.labels.showProfile"),selected:g==="profile",children:e.jsx(x,{disabled:!t,"data-testid":"social-menu-profile-button",color:"inherit",onClick:()=>r("profile"),"aria-label":o("dashboard.labels.showProfile"),children:e.jsx(K,{})})}),e.jsx(f,{tooltip:o("dashboard.labels.showRecommendations"),selected:g==="recommendations",children:e.jsx(x,{disabled:!t,"data-testid":"social-menu-recom-button",color:"inherit",onClick:()=>r("recommendations"),"aria-label":o("dashboard.labels.showRecommendations"),children:e.jsx(J,{})})}),e.jsx(v,{})]}),e.jsx(f,{tooltip:o("dashboard.labels.deleteUser"),children:e.jsx(x,{disabled:!t,color:"inherit",onClick:()=>d(!0),"aria-label":o("dashboard.labels.deleteUser"),children:e.jsx(E,{})})}),t&&e.jsx(A,{name:((P=m.getUserData(t))==null?void 0:P.name)||"No Name",open:c,onClose:()=>d(!1),onDelete:()=>{m.removeProfile(t),I.removeLogs(t),w.reset(),j(void 0),d(!1)}})]}):null}const _=1;function Ce({id:o,colour:u}){const a=te(o),c=se(a.image),[d,g]=N(S),r=C(k),t=R(),j=p.useRef(null),[l,b]=p.useState(300),i=p.useCallback(s=>{b(s)},[]);return e.jsxs("button",{tabIndex:0,"data-testid":`user-grid-item-${o}`,"aria-pressed":d===o,className:h.gridItem,onClick:s=>{g(n=>n===o?void 0:o),s.stopPropagation()},children:[e.jsxs("div",{className:h.userImageContainer,children:[r==="profileImage"&&c&&e.jsx("img",{src:c,alt:"","data-testid":`profile-image-${o}`}),r==="profileImage"&&!c&&e.jsx("div",{className:h.placeholder}),r==="image"&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:`${-(l*_)} ${-l} ${l*_*2} ${l*2}`,ref:j,"data-testid":`imagecloud-${o}`,children:e.jsx(re,{content:a.affinities.contents.contents.map(s=>({weight:s.weight,image:t.getContentData(s.id,!0)||""})),size:300,onSize:i,count:10})}),r==="word"&&e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",ref:j,"data-testid":`wordcloud-${o}`,viewBox:`${-(l*_)} ${-l} ${l*_*2} ${l*2}`,children:e.jsx(ae,{content:a.affinities.topics.topics,size:300,className:h.word,onSize:i})})]}),e.jsxs("div",{className:d===o?h.selectedUserNameContainer:h.userNameContainer,children:[e.jsx("div",{className:h.colourBox,style:{background:u}}),a.name]})]})}function Ie({users:o}){const{t:u}=z(),{profiler:a,similarity:c}=D(),d=ie(),g=p.useMemo(()=>d.users.filter(i=>i!==a.getCurrentUser()),[d,a]),r=o||g,t=C(V),j=M(S);p.useEffect(()=>{c.setK(t)},[t,c]);const l=Math.ceil(Math.sqrt(r.length))+1;let b=[];if(t>0){const i=new Map;r.forEach(n=>{var w;const m=((w=d.clusters.get(n))==null?void 0:w.label)||"nocluster",I=i.get(m)||[];I.push(n),i.set(m,I)});const s=Array.from(i);s.sort((n,m)=>m[0].localeCompare(n[0])),b=s.reduce((n,m)=>[...n,...m[1]],[])}else b=r;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:h.grid,style:{gridTemplateColumns:`repeat(${l}, 1fr)`},onClick:()=>j(void 0),"data-testid":"usergrid",children:[b.length===0&&e.jsx($,{loading:!0,message:u("dashboard.messages.waitingPeople")}),b.map(i=>{var n;const s=(n=d.clusters.get(i))==null?void 0:n.label;return e.jsx(Ce,{id:i,colour:s?ne(s):le.primary},i)})]}),e.jsx(je,{}),e.jsx(B,{}),e.jsx(G,{}),e.jsx(T,{}),e.jsx(W,{})]})}function Go(){const[o,u]=p.useReducer(c=>++c,0);de(()=>{u()},[],"refresh_graph");const a=M(S);return p.useEffect(()=>{a(void 0)},[a]),e.jsx(Ie,{},`k-${o}`)}export{Go as Component};
