import{c as d,j as s,r as m,a8 as h,I as p}from"./index-02b2945e.js";import{t as x,C as y,a as v,I as _}from"./ImageCloud-fcac825d.js";import"./ScorePie-ef00e97d.js";import"./colours.module-29b309d0.js";const w="#dfe5e8",j="_container_iathn_3",C="_outerContainer_iathn_14",I="_svgContainer_iathn_25",L={workspaceBg:w,container:j,outerContainer:C,svgContainer:I};function g(e,t){switch(e.activity){case"engagement":return t("feed.actionlog.engagement",{score:Math.min(10,Math.max(0,(e.value||0)*10)).toFixed()});case"inactive":return t("feed.actionlog.inactive",{time:((e.value||0)/1e3).toFixed(1)});case"dwell":return t("feed.actionlog.dwell",{time:((e.value||0)/1e3).toFixed(1)});case"comment":return t("feed.actionlog.comment",{length:e.value||0});default:return t(`feed.actionlog.${e.activity}`)}}const b="#e8f0fe",k="#444",$="#008297",D="_logItem_17ywp_3",E="_time_17ywp_19",B="_buttonListItem_17ywp_25",u={bgSubdued1:b,textDark:k,primary:$,logItem:D,time:E,buttonListItem:B};function F({item:e}){const{t}=d();return s.jsxs("div",{className:u.logItem,"data-testid":"log-item",children:[s.jsx("div",{children:g(e,t)}),s.jsx("div",{className:u.time,children:x(e.timestamp)})]})}const N=m.memo(function({batch:t}){const{t:i}=d();if(t.length===0)return null;const c=g(t[0].entry,i),a=t[0].content;return s.jsx(y,{message:c,image:a,score:t[0].entry.value||0,children:t.slice(1).map((r,o)=>s.jsx(F,{item:r.entry},o))})});function P(e,t){const i=[[]];if(e.length===0)return i;let c=!1;for(let a=0;a<e.length;++a){const r=e[a],o=i[i.length-1];if(o.length>0&&o[0].entry.id!==r.entry.id){if(c){i.push(...t.slice(1));break}i.push([r])}else o.push(r);const n=t[0],l=(n==null?void 0:n.length)-1;n&&n.length>0&&r.entry.id===n[l].entry.id&&r.entry.timestamp===n[l].entry.timestamp&&(c=!0)}if(e[0].entry.activity!=="engagement"){const a=h(i[0].map(r=>r.entry));i[0].unshift({entry:{activity:"engagement",timestamp:e[0].entry.timestamp,value:a,id:e[0].entry.id},content:e[0].content})}return i}function S({log:e,fixedSize:t}){const{t:i}=d(),[c,a]=m.useState(t||5),[r,o]=m.useState([]);return m.useEffect(()=>{a(t||5)},[t]),m.useEffect(()=>{o(n=>P(e,n))},[e]),s.jsxs(v,{children:[r.slice(0,c).map((n,l)=>s.jsx(N,{batch:n},l)),!t&&s.jsx("li",{className:u.buttonListItem,children:s.jsx(p,{variant:"outlined",onClick:()=>{a(n=>n+5)},sx:{margin:"1rem 0.5rem"},children:i("profile.actions.more")})})]})}const T=m.forwardRef(function({cloudSize:t=300,log:i,content:c,fixedSize:a},r){const[o,n]=m.useState(t),l=m.useCallback(f=>{n(f)},[]);return s.jsxs(s.Fragment,{children:[c&&s.jsx("div",{className:L.svgContainer,children:s.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:`${t}px`,viewBox:`${-(o*1.67)} ${-o} ${o*1.67*2} ${o*2}`,ref:r,children:s.jsx(_,{content:c,size:t,onSize:l})})}),s.jsx(S,{log:i,fixedSize:a})]})});export{T as D,L as s};
